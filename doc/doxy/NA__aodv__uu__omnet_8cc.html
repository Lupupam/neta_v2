<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NETWORK ATTACKS FRAMEWORK: NA_aodv_uu_omnet.cc File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">NETWORK ATTACKS FRAMEWORK
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A NETwork Attacks framework. Making network attacks impact evaluation easier!</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('NA__aodv__uu__omnet_8cc.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">NA_aodv_uu_omnet.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="NA__aodv__uu__omnet_8h_source.html">NA_aodv_uu_omnet.h</a>&quot;</code><br/>
<code>#include &quot;UDPPacket.h&quot;</code><br/>
<code>#include &quot;IPv4ControlInfo.h&quot;</code><br/>
<code>#include &quot;IPv6ControlInfo.h&quot;</code><br/>
<code>#include &quot;ICMPMessage_m.h&quot;</code><br/>
<code>#include &quot;ICMPAccess.h&quot;</code><br/>
<code>#include &quot;NotifierConsts.h&quot;</code><br/>
<code>#include &quot;IPv4Datagram.h&quot;</code><br/>
<code>#include &quot;IPv4InterfaceData.h&quot;</code><br/>
<code>#include &quot;ProtocolMap.h&quot;</code><br/>
<code>#include &quot;IPv4Address.h&quot;</code><br/>
<code>#include &quot;IPvXAddress.h&quot;</code><br/>
<code>#include &quot;ControlManetRouting_m.h&quot;</code><br/>
<code>#include &quot;Ieee802Ctrl_m.h&quot;</code><br/>
</div>
<p><a href="NA__aodv__uu__omnet_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; IPv4Address &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#abb3820de782b5197e0695186ca4462cd">IPAddressVector</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a34ee79883689c113671e06ae3172894f">Define_Module</a> (<a class="el" href="classNA__AODVUU.html">NA_AODVUU</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a5dce0c1a52d0def1b8c00036194ee853">initialize</a> (int stage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#ac64c0a26a140522ebd7d60272535e71f">~NA_AODVUU</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a377fe84396ac3b32067297f56dd2164a">handleMessageFromAttackController</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#ae281ab89be96795d96ef568ad395a7c5">packetFailed</a> (IPv4Datagram *dgram)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a719e65d72818a3b33a6178fad4a13821">packetFailedMac</a> (Ieee80211DataFrame *dgram)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a0f45a86aca07b4d03e53674c5a439e62">handleMessage</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#ac2022163ffdaa951d130a0aba7881552">startAODVUUAgent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">IPv4Datagram *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#aad0b14ba05f9ee915178379bee41ab47">pkt_encapsulate</a> (IPv4Datagram *p, IPv4Address gateway)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">IPv4Datagram *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#ad5ff0cdaf314807a4b4747e4e0085c71">pkt_decapsulate</a> (IPv4Datagram *p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a2e4aac37cd617a4ec5bccaeb11747534">if_indextoname</a> (int ifindex, char *ifname)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a8cb8c2e2b22e66445f91073114decaf8">recvAODVUUPacket</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a1f27f26ef21c3d67952b82bb3a400326">processPacket</a> (IPv4Datagram *p, unsigned int ifindex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdev__info.html">dev_info</a> <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a3c7ed6fe3d35fb4ca17caabbf688796d">dev_ifindex</a> (int ifindex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdev__info.html">dev_info</a> <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a29553947f06ffddd51f64b1d8aaea93a">dev_nr</a> (int n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a91edd642776bfe21bd48c985b2b28cc7">ifindex2devindex</a> (unsigned int ifindex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a10b108f7dc7dc50e3af3457f4448cc65">processLinkBreak</a> (const cPolymorphic *details)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a57ae8fc573fb73b2c8faa4e7fa597567">finish</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a31a79a067c7b48d2e495e9354700ea2d">getRoute</a> (const ManetAddress &amp;dest, std::vector&lt; ManetAddress &gt; &amp;add)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a8eff244afd75cbd50bf9f544115467b6">getNextHop</a> (const ManetAddress &amp;dest, ManetAddress &amp;add, int &amp;iface, double &amp;cost)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#aa64e11afca6cda15e3bf8be1864ca317">isProactive</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a877aca5e8d2deb5b3ed4a3b14bde93ca">setRefreshRoute</a> (const ManetAddress &amp;destination, const ManetAddress &amp;nextHop, bool isReverse)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#ae355e1c1c774a2f54c6896f1a0f865f5">isOurType</a> (cPacket *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a040bef6d7b1aa50d41a50f2bb87cc418">getDestAddress</a> (cPacket *msg, ManetAddress &amp;dest)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a02b4c17f3b5f244a29321bf62e72fe66">setRoute</a> (const ManetAddress &amp;dest, const ManetAddress &amp;add, const int &amp;ifaceIndex, const int &amp;hops, const ManetAddress &amp;mask)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a2638e88e0ea331164577605d09171491">setRoute</a> (const ManetAddress &amp;dest, const ManetAddress &amp;add, const char *ifaceName, const int &amp;hops, const ManetAddress &amp;mask)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__uu__omnet_8cc.html#aef334ff0aa0d9bd45ea8385f98a49805">UDP_HEADER_BYTES</a> = 8</td></tr>
</table>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="abb3820de782b5197e0695186ca4462cd"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::IPAddressVector" ref="abb3820de782b5197e0695186ca4462cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;IPv4Address&gt; <a class="el" href="NA__aodv__uu__omnet_8cc.html#abb3820de782b5197e0695186ca4462cd">IPAddressVector</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00056">56</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a34ee79883689c113671e06ae3172894f"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::Define_Module" ref="a34ee79883689c113671e06ae3172894f" args="(NA_AODVUU)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__aodv__uu__omnet_8cc.html#a34ee79883689c113671e06ae3172894f">Define_Module</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNA__AODVUU.html">NA_AODVUU</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3c7ed6fe3d35fb4ca17caabbf688796d"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::dev_ifindex" ref="a3c7ed6fe3d35fb4ca17caabbf688796d" args="(int ifindex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdev__info.html">dev_info</a> <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a3c7ed6fe3d35fb4ca17caabbf688796d">dev_ifindex</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifindex</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01065">1065</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> index = <a class="code" href="NA__aodv__uu__omnet_8cc.html#a91edd642776bfe21bd48c985b2b28cc7">ifindex2devindex</a>(ifindex);
    <span class="keywordflow">return</span>  (<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#af325a2d90f432c9fce1e19488e6b71bf">devs</a>[index]);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a29553947f06ffddd51f64b1d8aaea93a"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::dev_nr" ref="a29553947f06ffddd51f64b1d8aaea93a" args="(int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdev__info.html">dev_info</a> <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a29553947f06ffddd51f64b1d8aaea93a">dev_nr</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01071">1071</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> (<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#af325a2d90f432c9fce1e19488e6b71bf">devs</a>[n]);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a57ae8fc573fb73b2c8faa4e7fa597567"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::finish" ref="a57ae8fc573fb73b2c8faa4e7fa597567" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a57ae8fc573fb73b2c8faa4e7fa597567">finish</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01106">1106</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{

    simtime_t t = simTime();
    <span class="keywordflow">if</span> (t==0)
        <span class="keywordflow">return</span>;
    <span class="keywordflow">if</span> (iswrite)
        <span class="keywordflow">return</span>;
    iswrite=<span class="keyword">true</span>;
    recordScalar(<span class="stringliteral">&quot;simulated time&quot;</span>, t);
    recordScalar(<span class="stringliteral">&quot;Aodv totalSend &quot;</span>, totalSend);
    recordScalar(<span class="stringliteral">&quot;rreq send&quot;</span>, totalRreqSend);
    recordScalar(<span class="stringliteral">&quot;rreq rec&quot;</span>, totalRreqRec);
    recordScalar(<span class="stringliteral">&quot;rrep send&quot;</span>, totalRrepSend);
    recordScalar(<span class="stringliteral">&quot;rrep rec&quot;</span>, totalRrepRec);
    recordScalar(<span class="stringliteral">&quot;rrep ack send&quot;</span>, totalRrepAckSend);
    recordScalar(<span class="stringliteral">&quot;rrep ack rec&quot;</span>, totalRrepAckRec);
    recordScalar(<span class="stringliteral">&quot;rerr send&quot;</span>, totalRerrSend);
    recordScalar(<span class="stringliteral">&quot;rerr rec&quot;</span>, totalRerrRec);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a040bef6d7b1aa50d41a50f2bb87cc418"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::getDestAddress" ref="a040bef6d7b1aa50d41a50f2bb87cc418" args="(cPacket *msg, ManetAddress &amp;dest)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a040bef6d7b1aa50d41a50f2bb87cc418">getDestAddress</a> </td>
          <td>(</td>
          <td class="paramtype">cPacket *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01239">1239</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structRREQ.html">RREQ</a> *rreq = dynamic_cast &lt;<a class="code" href="structRREQ.html">RREQ</a> *&gt;(msg);
    <span class="keywordflow">if</span> (!rreq)
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    dest = rreq-&gt;<a class="code" href="structRREQ.html#a45d9523cee3586f9529f7a8035a3639e">dest_addr</a>;
    <span class="keywordflow">return</span> <span class="keyword">true</span>;

}
</pre></div>
</div>
</div>
<a class="anchor" id="a8eff244afd75cbd50bf9f544115467b6"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::getNextHop" ref="a8eff244afd75cbd50bf9f544115467b6" args="(const ManetAddress &amp;dest, ManetAddress &amp;add, int &amp;iface, double &amp;cost)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a8eff244afd75cbd50bf9f544115467b6">getNextHop</a> </td>
          <td>(</td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>iface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>cost</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01134">1134</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>in_addr destAddr;
    destAddr.s_addr = dest;
    ManetAddress apAddr;
    <a class="code" href="structrt__table.html">rt_table_t</a> * fwd_rt = this-&gt;<a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(destAddr);
    <span class="keywordflow">if</span> (fwd_rt)
    {
        <span class="keywordflow">if</span> (fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> != <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        add = fwd_rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr;
        InterfaceEntry * ie = getInterfaceEntry (fwd_rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
        iface = ie-&gt;getInterfaceId();
        cost = fwd_rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>;
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (getAp(dest,apAddr))
    {
        destAddr.s_addr = apAddr;
        fwd_rt = this-&gt;<a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(destAddr);
        <span class="keywordflow">if</span> (!fwd_rt)
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        <span class="keywordflow">if</span> (fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> != <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
            <span class="keywordflow">return</span> <span class="keyword">false</span>;
        add = fwd_rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr;
        InterfaceEntry * ie = getInterfaceEntry (fwd_rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
        iface = ie-&gt;getInterfaceId();
        cost = fwd_rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>;
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a31a79a067c7b48d2e495e9354700ea2d"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::getRoute" ref="a31a79a067c7b48d2e495e9354700ea2d" args="(const ManetAddress &amp;dest, std::vector&lt; ManetAddress &gt; &amp;add)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a31a79a067c7b48d2e495e9354700ea2d">getRoute</a> </td>
          <td>(</td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; ManetAddress &gt; &amp;&#160;</td>
          <td class="paramname"><em>add</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01128">1128</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0f45a86aca07b4d03e53674c5a439e62"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::handleMessage" ref="a0f45a86aca07b4d03e53674c5a439e62" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a0f45a86aca07b4d03e53674c5a439e62">handleMessage</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00528">528</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structAODV__msg.html">AODV_msg</a> *aodvMsg=NULL;
    IPv4Datagram * ipDgram=NULL;
    UDPPacket * udpPacket=NULL;

    cMessage *msg_aux;
    <span class="keyword">struct </span>in_addr src_addr;
    <span class="keyword">struct </span>in_addr dest_addr;

    <span class="keywordflow">if</span> (is_init==<span class="keyword">false</span>)
        opp_error (<span class="stringliteral">&quot;Aodv has not been initialized &quot;</span>);
    <span class="keywordflow">if</span> (msg==sendMessageEvent)
    {
        <span class="comment">// timer event</span>
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }
    <span class="comment">/* Handle packet depending on type */</span>
    <span class="keywordflow">if</span> (dynamic_cast&lt;ControlManetRouting *&gt;(msg))
    {
        ControlManetRouting * control =  check_and_cast &lt;ControlManetRouting *&gt; (msg);
        <span class="keywordflow">if</span> (control-&gt;getOptionCode()== MANET_ROUTE_NOROUTE)
        {
            ipDgram = (IPv4Datagram*) control-&gt;decapsulate();
            cPolymorphic * ctrl = ipDgram-&gt;removeControlInfo();
            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ifindex = NS_IFINDEX;  <span class="comment">/* Always use ns interface */</span>
            <span class="keywordflow">if</span> (ctrl)
            {
                <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee802Ctrl*&gt; (ctrl))
                {
                    Ieee802Ctrl *ieeectrl = <span class="keyword">dynamic_cast&lt;</span>Ieee802Ctrl*<span class="keyword">&gt;</span> (ctrl);
                    ManetAddress address(ieeectrl-&gt;getDest());
                    <span class="keywordtype">int</span> index = getWlanInterfaceIndexByAddress(address);
                    <span class="keywordflow">if</span> (index!=-1)
                        ifindex = index;
                }
                <span class="keyword">delete</span> ctrl;
            }

            EV &lt;&lt; <span class="stringliteral">&quot;Aodv rec datagram  &quot;</span> &lt;&lt; ipDgram-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; with dest=&quot;</span> &lt;&lt; ipDgram-&gt;getDestAddress().str() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
            <a class="code" href="NA__aodv__uu__omnet_8cc.html#a1f27f26ef21c3d67952b82bb3a400326">processPacket</a>(ipDgram,ifindex);   <span class="comment">// Data path</span>
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (control-&gt;getOptionCode()== MANET_ROUTE_UPDATE)
        {
            <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;forwarding packers, actualize time outs&quot;</span>);
            src_addr.s_addr = control-&gt;getSrcAddress();
            dest_addr.s_addr = control-&gt;getDestAddress();
            <a class="code" href="structrt__table.html">rt_table_t</a> * fwd_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(dest_addr);
            <a class="code" href="structrt__table.html">rt_table_t</a> * rev_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(src_addr);
            <a class="code" href="NA__routing__table_8cc.html#a438604d7812eff676f0273d700177bc8">rt_table_update_route_timeouts</a>(fwd_rt, rev_rt);
            <span class="comment">/* When forwarding data, make sure we are sending HELLO messages */</span>
            gettimeofday(&amp;<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#a0685a8df41c78308172736070f16bcfa">fwd_time</a>, NULL);
        }
        <span class="keyword">delete</span> msg;
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;UDPPacket *&gt;(msg) || dynamic_cast&lt;AODV_msg  *&gt;(msg))
    {
        udpPacket = NULL;
        <span class="keywordflow">if</span> (!isInMacLayer())
        {
            udpPacket = check_and_cast&lt;UDPPacket*&gt;(msg);
            <span class="keywordflow">if</span> (udpPacket-&gt;getDestinationPort()!= 654)
            {
                <span class="keyword">delete</span>  msg;
                <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
                <span class="keywordflow">return</span>;
            }
            msg_aux  = udpPacket-&gt;decapsulate();
        }
        <span class="keywordflow">else</span>
            msg_aux = msg;

        <span class="keywordflow">if</span> (dynamic_cast&lt;AODV_msg  *&gt;(msg_aux))
        {
            aodvMsg = check_and_cast  &lt;<a class="code" href="structAODV__msg.html">AODV_msg</a> *&gt;(msg_aux);
            <span class="keywordflow">if</span> (!isInMacLayer())
            {
                IPv4ControlInfo *controlInfo = check_and_cast&lt;IPv4ControlInfo*&gt;(udpPacket-&gt;removeControlInfo());
                src_addr.s_addr = ManetAddress(controlInfo-&gt;getSrcAddr());
                aodvMsg-&gt;setControlInfo(controlInfo);
            }
            <span class="keywordflow">else</span>
            {
                Ieee802Ctrl *controlInfo = check_and_cast&lt;Ieee802Ctrl*&gt;(udpPacket-&gt;getControlInfo());
                src_addr.s_addr = ManetAddress(controlInfo-&gt;getSrc());
            }
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">if</span> (udpPacket)
                <span class="keyword">delete</span> udpPacket;
            <span class="keyword">delete</span> msg_aux;
            <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
            <span class="keywordflow">return</span>;

        }

        <span class="keywordflow">if</span> (udpPacket)
            <span class="keyword">delete</span> udpPacket;
    }
    <span class="keywordflow">else</span>
    {
        <span class="keyword">delete</span> msg;
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }
    <span class="comment">/* Detect routing loops */</span>
    <span class="keywordflow">if</span> (isLocalAddress(src_addr.s_addr))
    {
        <span class="keyword">delete</span> aodvMsg;
        aodvMsg=NULL;
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }
    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a8cb8c2e2b22e66445f91073114decaf8">recvAODVUUPacket</a>(aodvMsg);
    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a377fe84396ac3b32067297f56dd2164a"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::handleMessageFromAttackController" ref="a377fe84396ac3b32067297f56dd2164a" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a377fe84396ac3b32067297f56dd2164a">handleMessageFromAttackController</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00343">343</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">                                                              {

    <span class="comment">// It is necessary to call Enter_Method for doing context switching (4.10 of User Manual)</span>
    Enter_Method(<span class="stringliteral">&quot;NA_AODVUU: handle message from attack controller&quot;</span>);

    <a class="code" href="NA__NesgLog_8h.html#a159ca84d25a5487d8e81e4438725df19" title="LOG macro.">LOG</a> &lt;&lt; <span class="stringliteral">&quot;NA_AODVUU: Received message: &quot;</span>&lt;&lt; msg-&gt;getFullName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;

    <span class="comment">// BEGIN NA_SINKHOLE - sancale</span>
    <span class="comment">// Activate sinkhole</span>
    <span class="keywordflow">if</span> (not strcmp(msg-&gt;getFullName(), <span class="stringliteral">&quot;sinkholeActivate&quot;</span>)) {
        NA_SinkholeMessage *dmsg;
        dmsg = check_and_cast&lt;NA_SinkholeMessage *&gt;(msg);
        <a class="code" href="NA__NesgLog_8h.html#a159ca84d25a5487d8e81e4438725df19" title="LOG macro.">LOG</a> &lt;&lt; <span class="stringliteral">&quot;--&gt; Activating module NA_AODVUU for Sinkhole...\n&quot;</span>;
        LOG &lt;&lt; <span class="stringliteral">&quot;    Sinkhole Probability received: &quot;</span>&lt;&lt; dmsg-&gt;getSinkholeAttackProbability() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
        LOG &lt;&lt; <span class="stringliteral">&quot;    Sink only when route in table: &quot;</span> &lt;&lt; dmsg-&gt;getSinkOnlyWhenRouteInTable() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
        <span class="comment">//Now sinkhole attack is activated in this module</span>
        sinkholeAttackIsActive = <span class="keyword">true</span>;
        sinkholeAttackProbability = dmsg-&gt;getSinkholeAttackProbability();
        sinkOnlyWhenRouteInTable = dmsg-&gt;getSinkOnlyWhenRouteInTable();
        seqnoAdded = dmsg-&gt;getSeqnoAdded();
        numHops = dmsg-&gt;getNumHops();
        <span class="keyword">delete</span>(msg);

        <span class="comment">// Deactivate sinkhole</span>
    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (not strcmp(msg-&gt;getFullName(), <span class="stringliteral">&quot;sinkholeDeactivate&quot;</span>)) {
        NA_SinkholeMessage *dmsg;
        dmsg = check_and_cast&lt;NA_SinkholeMessage *&gt;(msg);
        LOG &lt;&lt; <span class="stringliteral">&quot;Deactivating module NA_AODVUU for Sinkhole...\n&quot;</span>;
        <span class="comment">//Now sinkholes attack is deactivated</span>
        sinkholeAttackIsActive = <span class="keyword">false</span>;
        seqnoAdded = NULL;
        numHops = NULL;
        <span class="keyword">delete</span>(msg);
     <span class="comment">// END NA_SINKHOLE - sancale</span>

    } <span class="keywordflow">else</span> {
        LOG &lt;&lt; <span class="stringliteral">&quot;ERROR: Message unknown in NA_AODVUU::handleMessageFromAttackController. Msg: &quot;</span> &lt;&lt; msg-&gt;getFullName() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2e4aac37cd617a4ec5bccaeb11747534"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::if_indextoname" ref="a2e4aac37cd617a4ec5bccaeb11747534" args="(int ifindex, char *ifname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a2e4aac37cd617a4ec5bccaeb11747534">if_indextoname</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ifname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00831">831</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    InterfaceEntry *   ie;
    assert(ifindex &gt;= 0);
    ie = getInterfaceEntry(ifindex);
    <span class="keywordflow">return</span> ie-&gt;getName();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a91edd642776bfe21bd48c985b2b28cc7"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::ifindex2devindex" ref="a91edd642776bfe21bd48c985b2b28cc7" args="(unsigned int ifindex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a91edd642776bfe21bd48c985b2b28cc7">ifindex2devindex</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ifindex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01076">1076</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> i;
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#aac008fcec2a6f263cdb7a328a1677a62">nif</a>; i++)
        <span class="keywordflow">if</span> (<a class="code" href="NA__defs__aodv_8h.html#aadc3440bff34bbc102e29a41aa256e18">dev_indices</a>[i] == ifindex)
            <span class="keywordflow">return</span> i;
    <span class="keywordflow">return</span> -1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5dce0c1a52d0def1b8c00036194ee853"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::initialize" ref="a5dce0c1a52d0def1b8c00036194ee853" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a5dce0c1a52d0def1b8c00036194ee853">initialize</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00078">78</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
     <span class="comment">/*</span>
<span class="comment">       Enable usage of some of the configuration variables from Tcl.</span>
<span class="comment"></span>
<span class="comment">       Note: Do NOT change the values of these variables in the constructor</span>
<span class="comment">       after binding them! The desired default values should be set in</span>
<span class="comment">       ~ns/tcl/lib/ns-default.tcl instead.</span>
<span class="comment">     */</span>
    <span class="keywordflow">if</span> (stage==4)
    {
<span class="preprocessor">#ifndef AODV_GLOBAL_STATISTISTIC</span>
<span class="preprocessor"></span>        iswrite = <span class="keyword">false</span>;
        totalSend=0;
        totalRreqSend=0;
        totalRreqRec=0;
        totalRrepSend=0;
        totalRrepRec=0;
        totalRrepAckSend=0;
        totalRrepAckRec=0;
        totalRerrSend=0;
        totalRerrRec=0;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a> = 0;
        <a class="code" href="main_8c.html#a5195b41adb4586d2ad897d08ebb3dfad">hello_jittering</a> = 0;
        <a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a> = 0;
        <a class="code" href="main_8c.html#a09464654a5c100dc4840caefec4672b0">expanding_ring_search</a> = 0;
        <a class="code" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> = 0;
        <a class="code" href="NA__debug__aodv_8h.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=0;
        <a class="code" href="main_8c.html#a9114356a8b6ad57f39c4d50388776531">rreq_gratuitous</a> =0;

        <span class="comment">// BEGIN NA_SINKHOLE - sancale</span>
        <span class="comment">// Sinkhole attack initialization</span>
        sinkholeAttackIsActive = <span class="keyword">false</span>;
        sinkholeAttackProbability = 0;
        sinkOnlyWhenRouteInTable = <span class="keyword">false</span>;
        numSents = 0;
        <span class="comment">// END NA_SINKHOLE - sancale</span>

        <span class="comment">//sendMessageEvent = new cMessage();</span>
        <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)par(<span class="stringliteral">&quot;log_to_file&quot;</span>))
            <a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a> = 1;

        <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>) par(<span class="stringliteral">&quot;hello_jittering&quot;</span>))
            <a class="code" href="main_8c.html#a5195b41adb4586d2ad897d08ebb3dfad">hello_jittering</a> = 1;

        <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)par(<span class="stringliteral">&quot;optimized_hellos&quot;</span>))
            <a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a>  = 1;

        <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)par(<span class="stringliteral">&quot;expanding_ring_search&quot;</span>))
            <a class="code" href="main_8c.html#a09464654a5c100dc4840caefec4672b0">expanding_ring_search</a> = 1;

        <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>) par(<span class="stringliteral">&quot;local_repair&quot;</span>))
            <a class="code" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> = 1;

        <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)par(<span class="stringliteral">&quot;rreq_gratuitous&quot;</span>))
            <a class="code" href="main_8c.html#a9114356a8b6ad57f39c4d50388776531">rreq_gratuitous</a> = 1;

        <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)par(<span class="stringliteral">&quot;debug&quot;</span>))
            <a class="code" href="NA__debug__aodv_8h.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> = 1;

        useIndex = par(<span class="stringliteral">&quot;UseIndex&quot;</span>);
        <a class="code" href="main_8c.html#ae55eec632e369a4afc18e804bae8f3e4">unidir_hack</a> = (int) par(<span class="stringliteral">&quot;unidir_hack&quot;</span>);

        <a class="code" href="main_8c.html#aa10c5b3c1ff250cd241fe589fdf92253">receive_n_hellos</a>    = (int) par(<span class="stringliteral">&quot;receive_n_hellos&quot;</span>);
        <a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a> = (int) par (<span class="stringliteral">&quot;wait_on_reboot&quot;</span>);
        <a class="code" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a> = (int) par(<span class="stringliteral">&quot;rt_log_interval&quot;</span>); <span class="comment">// Note: in milliseconds!</span>
        <a class="code" href="main_8c.html#a3ecfcf4b066b9c242e176393695e38d0">ratelimit</a> = (int) par(<span class="stringliteral">&quot;ratelimit&quot;</span>);
        <a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> = 0;
        <span class="keywordflow">if</span> (par(<span class="stringliteral">&quot;llfeedback&quot;</span>))
            <a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> = 1;
        <a class="code" href="main_8c.html#a6be52079b3b26f9986ccdddfbca964e6">internet_gw_mode</a> = (int) par(<span class="stringliteral">&quot;internet_gw_mode&quot;</span>);
        gateWayAddress = <span class="keyword">new</span> IPv4Address(par(<span class="stringliteral">&quot;internet_gw_address&quot;</span>).stringValue());

        <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a>)
        {
            <a class="code" href="main_8c.html#a1b01d3369a884952b1b133647b6f8972">active_route_timeout</a> = <a class="code" href="NA__params_8h.html#a42ed2e9e7d24d26a1d0092373d4de678">ACTIVE_ROUTE_TIMEOUT_LLF</a>;
            <a class="code" href="main_8c.html#ab0e1b854de69ed4c072e72f977599c95">ttl_start</a> = <a class="code" href="NA__params_8h.html#adbe0e5532d6a779e20789e312cf36ddf">TTL_START_LLF</a>;
            <a class="code" href="main_8c.html#ab2f352af0fd66527b61319af50f5f50a">delete_period</a> =  <a class="code" href="NA__params_8h.html#a57180018d38784864259f54f62713a56">DELETE_PERIOD_LLF</a>;
        }
        <span class="keywordflow">else</span>
        {
            <a class="code" href="main_8c.html#a1b01d3369a884952b1b133647b6f8972">active_route_timeout</a> = (int) par(<span class="stringliteral">&quot;active_timeout&quot;</span>);<span class="comment">// ACTIVE_ROUTE_TIMEOUT_HELLO;</span>
            <a class="code" href="main_8c.html#ab0e1b854de69ed4c072e72f977599c95">ttl_start</a> = <a class="code" href="NA__params_8h.html#a85895a7aa8febd51e264593000ed7c4c">TTL_START_HELLO</a>;
            <a class="code" href="main_8c.html#ab2f352af0fd66527b61319af50f5f50a">delete_period</a> = <a class="code" href="NA__params_8h.html#ac9cc85aa90ba4bc5a62071f6fdd31d5a">DELETE_PERIOD_HELLO</a>;
        }

        <span class="comment">/* Initialize common manet routing protocol structures */</span>
        registerRoutingModule();
        <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a>)
            linkLayerFeeback();

        <span class="comment">/* From main.c */</span>
        <a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a> = strdup(<span class="stringliteral">&quot;AODV-UU&quot;</span>);
        <span class="comment">/* From debug.c */</span>
        <span class="comment">/* Note: log_nmsgs was never used anywhere */</span>
        log_nmsgs = 0;
        log_rt_fd = -1;
<span class="preprocessor">#ifndef  _WIN32</span>
<span class="preprocessor"></span>
        <span class="keywordflow">if</span> (debug &amp;&amp; !log_file_fd_init)
        {
            log_file_fd = -1;
            openlog(<span class="stringliteral">&quot;aodv-uu &quot;</span>,0,LOG_USER);
            <a class="code" href="NA__debug__aodv_8cc.html#aecfc084a466c1e43aa3fc757e1ba3818">log_init</a>();
            log_file_fd_init=<span class="keyword">true</span>;
        }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        <a class="code" href="NA__debug__aodv_8h.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a> = 0;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="comment">/* Set host parameters */</span>
        memset(&amp;<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structhost__info.html">host_info</a>));
        memset(<a class="code" href="NA__defs__aodv_8h.html#aadc3440bff34bbc102e29a41aa256e18">dev_indices</a>, 0, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) * <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>);
        <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#a42c045dee154a8fd24c7081602aff457">seqno</a> = 1;
        <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#ad7cd479f367ded9d8884f1f8c8dd5f02">rreq_id</a> = 0;
        <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#aac008fcec2a6f263cdb7a328a1677a62">nif</a> = 1;


        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>; i++)
            <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).enabled=0;

        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;getNumInterfaces(); i++)
        {
            <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ifindex = i;
            <a class="code" href="NA__defs__aodv_8h.html#aadc3440bff34bbc102e29a41aa256e18">dev_indices</a>[i] = i;
            strcpy(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ifname, getInterfaceEntry(i)-&gt;<a class="code" href="utilidades_8cc.html#af5b5c4787ffe48b5c4fc01aea42cd1c4">getName</a>());
            <span class="keywordflow">if</span> (!isInMacLayer())
            {
                <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).netmask.s_addr =
                    ManetAddress(getInterfaceEntry(i)-&gt;ipv4Data()-&gt;getIPAddress().getNetworkMask());
                <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ipaddr.s_addr =
                        ManetAddress(getInterfaceEntry(i)-&gt;ipv4Data()-&gt;getIPAddress());
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).netmask.s_addr = ManetAddress(MACAddress::BROADCAST_ADDRESS);
                <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ipaddr.s_addr = ManetAddress(getInterfaceEntry(i)-&gt;getMacAddress());

            }
        }
        <span class="comment">/* Set network interface parameters */</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; getNumWlanInterfaces(); i++)
        {
            <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(getWlanInterfaceIndex(i)).enabled = 1;
            <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(getWlanInterfaceIndex(i)).sock = -1;
            <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(getWlanInterfaceIndex(i)).broadcast.s_addr = ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>));
        }

        NS_DEV_NR = getWlanInterfaceIndexByAddress();
        NS_IFINDEX = getWlanInterfaceIndexByAddress();
<span class="preprocessor">#ifndef AODV_USE_STL</span>
<span class="preprocessor"></span>        <a class="code" href="structlist__t.html">list_t</a> *lista_ptr;
        lista_ptr=&amp;rreq_records;
        <a class="code" href="NA__list_8h.html#a751e0595c81c7eb920acb6bf18960e75">INIT_LIST_HEAD</a>(&amp;rreq_records);
        lista_ptr=&amp;rreq_blacklist;
        <a class="code" href="NA__list_8h.html#a751e0595c81c7eb920acb6bf18960e75">INIT_LIST_HEAD</a>(&amp;rreq_blacklist);
        lista_ptr=&amp;seekhead;
        <a class="code" href="NA__list_8h.html#a751e0595c81c7eb920acb6bf18960e75">INIT_LIST_HEAD</a>(&amp;seekhead);

        lista_ptr=&amp;TQ;
        <a class="code" href="NA__list_8h.html#a751e0595c81c7eb920acb6bf18960e75">INIT_LIST_HEAD</a>(&amp;TQ);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="comment">/* Initialize data structures */</span>
        <a class="code" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a>.<a class="code" href="structtimer.html#a63c6ec909c89f16deb5580f74a29d981">data</a> = NULL;
        <a class="code" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a>.<a class="code" href="structtimer.html#aae497dabc6a07ecae336dd90c8c3aa0e">used</a> = 0;
        hello_timer.data = NULL;
        hello_timer.used = 0;
        rt_log_timer.data = NULL;
        rt_log_timer.used = 0;
        isRoot = par(<span class="stringliteral">&quot;isRoot&quot;</span>);
        costStatic = par(<span class="stringliteral">&quot;costStatic&quot;</span>);
        costMobile = par(<span class="stringliteral">&quot;costMobile&quot;</span>);
        useHover = par(<span class="stringliteral">&quot;useHover&quot;</span>);
        proactive_rreq_timeout= par(<span class="stringliteral">&quot;proactiveRreqTimeout&quot;</span>).longValue();

        <span class="keywordflow">if</span> (isRoot)
        {
            <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;proactive_rreq_timer,&amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__rreq_8cc.html#aefb850efc65ffce9a0286d511830d3e9">rreq_proactive</a>, NULL);
            <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;proactive_rreq_timer, proactive_rreq_timeout);
        }

        propagateProactive = par(<span class="stringliteral">&quot;propagateProactive&quot;</span>);
        strcpy(nodeName,getParentModule()-&gt;getParentModule()-&gt;<a class="code" href="utilidades_8cc.html#aec3361ebcbcb1526f2f0fff6187169f0">getFullName</a>());
        <a class="code" href="NA__aodv__socket_8cc.html#a46b63fe67cacd677eb832c40f1466dc0">aodv_socket_init</a>();
        <a class="code" href="NA__routing__table_8cc.html#af55d0c061f4060fa7df11209b4b0fdbf">rt_table_init</a>();
        <a class="code" href="NA__packet__queue__omnet_8cc.html#ae755aa26d7987f288c1ae6763d66f5f4">packet_queue_init</a>();
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#ac2022163ffdaa951d130a0aba7881552">startAODVUUAgent</a>();

        is_init=<span class="keyword">true</span>;
        <span class="comment">// Initialize the timer</span>
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        ev &lt;&lt; <span class="stringliteral">&quot;Aodv active&quot;</span>&lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae355e1c1c774a2f54c6896f1a0f865f5"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::isOurType" ref="ae355e1c1c774a2f54c6896f1a0f865f5" args="(cPacket *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#ae355e1c1c774a2f54c6896f1a0f865f5">isOurType</a> </td>
          <td>(</td>
          <td class="paramtype">cPacket *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01231">1231</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structAODV__msg.html">AODV_msg</a> *re = dynamic_cast &lt;<a class="code" href="structAODV__msg.html">AODV_msg</a> *&gt;(msg);
    <span class="keywordflow">if</span> (re)
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa64e11afca6cda15e3bf8be1864ca317"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::isProactive" ref="aa64e11afca6cda15e3bf8be1864ca317" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#aa64e11afca6cda15e3bf8be1864ca317">isProactive</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01167">1167</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae281ab89be96795d96ef568ad395a7c5"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::packetFailed" ref="ae281ab89be96795d96ef568ad395a7c5" args="(IPv4Datagram *dgram)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#ae281ab89be96795d96ef568ad395a7c5">packetFailed</a> </td>
          <td>(</td>
          <td class="paramtype">IPv4Datagram *&#160;</td>
          <td class="paramname"><em>dgram</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00390">390</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structrt__table.html">rt_table_t</a> *rt_next_hop, *rt;
    <span class="keyword">struct </span>in_addr dest_addr, src_addr, next_hop;

    src_addr.s_addr = ManetAddress(dgram-&gt;getSrcAddress());
    dest_addr.s_addr = ManetAddress(dgram-&gt;getDestAddress());


    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Got failure callback&quot;</span>);
    <span class="comment">/* We don&#39;t care about link failures for broadcast or non-data packets */</span>
    <span class="keywordflow">if</span> (dgram-&gt;getDestAddress().getInt() == IP_BROADCAST ||
            dgram-&gt;getDestAddress().getInt() == <a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>)
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Ignoring callback&quot;</span>);
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }


    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;LINK FAILURE for next_hop=%s dest=%s &quot;</span>,<a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(next_hop), <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest_addr));

    <span class="keywordflow">if</span> (<a class="code" href="NA__seek__list_8cc.html#ae26827bd74face659624808c4d7bd517">seek_list_find</a>(dest_addr))
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Ongoing route discovery, buffering packet...&quot;</span>);
        <a class="code" href="NA__packet__queue__omnet_8cc.html#abca7137accdfd65a117cc2df8a1cec70">packet_queue_add</a>((IPv4Datagram *)dgram-&gt;dup(), dest_addr);
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }


    rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(dest_addr);

    <span class="keywordflow">if</span> (!rt || rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
    {
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }
    next_hop.s_addr = rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr;
    rt_next_hop = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(next_hop);

    <span class="keywordflow">if</span> (!rt_next_hop || rt_next_hop-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
    {
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }

    <span class="comment">/* Do local repair? */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> &amp;&amp; rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> &lt;= <a class="code" href="NA__params_8h.html#aa2eb3312431e83f4a41ef8926487c5cf">MAX_REPAIR_TTL</a>)
        <span class="comment">/* &amp;&amp; ch-&gt;num_forwards() &gt; rt-&gt;hcnt */</span>
    {
        <span class="comment">/* Buffer the current packet */</span>
        <a class="code" href="NA__packet__queue__omnet_8cc.html#abca7137accdfd65a117cc2df8a1cec70">packet_queue_add</a>((IPv4Datagram *) dgram-&gt;dup(), dest_addr);

        <span class="comment">// In omnet++ it&#39;s not possible to access to the mac queue</span>
        <span class="comment">//  /* Buffer pending packets from interface queue */</span>
        <span class="comment">//  interfaceQueue((nsaddr_t) next_hop.s_addr, IFQ_BUFFER);</span>
        <span class="comment">//  /* Mark the route to be repaired */</span>
        rt_next_hop-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> |= <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>;
        <a class="code" href="NA__aodv__neighbor_8cc.html#ac0b48998364c3e0b91b3b866808187f0">neighbor_link_break</a>(rt_next_hop);
        <a class="code" href="NA__aodv__rreq_8cc.html#a44f18f90d4862d93f99c2b197ba61fa3">rreq_local_repair</a>(rt, src_addr, NULL);
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">/* No local repair - just force timeout of link and drop packets */</span>
        <a class="code" href="NA__aodv__neighbor_8cc.html#ac0b48998364c3e0b91b3b866808187f0">neighbor_link_break</a>(rt_next_hop);
<span class="comment">// In omnet++ it&#39;s not possible to access to the mac queue</span>
<span class="comment">//  interfaceQueue((nsaddr_t) next_hop.s_addr, IFQ_DROP);</span>
    }
    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a719e65d72818a3b33a6178fad4a13821"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::packetFailedMac" ref="a719e65d72818a3b33a6178fad4a13821" args="(Ieee80211DataFrame *dgram)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a719e65d72818a3b33a6178fad4a13821">packetFailedMac</a> </td>
          <td>(</td>
          <td class="paramtype">Ieee80211DataFrame *&#160;</td>
          <td class="paramname"><em>dgram</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00464">464</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structrt__table.html">rt_table_t</a> *rt_next_hop, *rt;
    <span class="keyword">struct </span>in_addr dest_addr, src_addr, next_hop;
    <span class="keywordflow">if</span> (dgram-&gt;getReceiverAddress().isBroadcast())
    {
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }

    src_addr.s_addr = ManetAddress(dgram-&gt;getAddress3());
    dest_addr.s_addr = ManetAddress(dgram-&gt;getAddress4());
    <span class="keywordflow">if</span> (<a class="code" href="NA__seek__list_8cc.html#ae26827bd74face659624808c4d7bd517">seek_list_find</a>(dest_addr))
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Ongoing route discovery, buffering packet...&quot;</span>);
        <a class="code" href="NA__packet__queue__omnet_8cc.html#abca7137accdfd65a117cc2df8a1cec70">packet_queue_add</a>(dgram-&gt;dup(), dest_addr);
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }

    rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(dest_addr);

    <span class="keywordflow">if</span> (!rt || rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
    {
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }
    next_hop.s_addr = rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr;
    rt_next_hop = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(next_hop);

    <span class="keywordflow">if</span> (!rt_next_hop || rt_next_hop-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
    {
        <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
        <span class="keywordflow">return</span>;
    }

    <span class="comment">/* Do local repair? */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> &amp;&amp; rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> &lt;= <a class="code" href="NA__params_8h.html#aa2eb3312431e83f4a41ef8926487c5cf">MAX_REPAIR_TTL</a>)
        <span class="comment">/* &amp;&amp; ch-&gt;num_forwards() &gt; rt-&gt;hcnt */</span>
    {
        <span class="comment">/* Buffer the current packet */</span>
        <a class="code" href="NA__packet__queue__omnet_8cc.html#abca7137accdfd65a117cc2df8a1cec70">packet_queue_add</a>(dgram-&gt;dup(), dest_addr);

        <span class="comment">// In omnet++ it&#39;s not possible to access to the mac queue</span>
        <span class="comment">//  /* Buffer pending packets from interface queue */</span>
        <span class="comment">//  interfaceQueue((nsaddr_t) next_hop.s_addr, IFQ_BUFFER);</span>
        <span class="comment">//  /* Mark the route to be repaired */</span>
        rt_next_hop-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> |= <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>;
        <a class="code" href="NA__aodv__neighbor_8cc.html#ac0b48998364c3e0b91b3b866808187f0">neighbor_link_break</a>(rt_next_hop);
        <a class="code" href="NA__aodv__rreq_8cc.html#a44f18f90d4862d93f99c2b197ba61fa3">rreq_local_repair</a>(rt, src_addr, NULL);
    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">/* No local repair - just force timeout of link and drop packets */</span>
        <a class="code" href="NA__aodv__neighbor_8cc.html#ac0b48998364c3e0b91b3b866808187f0">neighbor_link_break</a>(rt_next_hop);
<span class="comment">// In omnet++ it&#39;s not possible to access to the mac queue</span>
<span class="comment">//  interfaceQueue((nsaddr_t) next_hop.s_addr, IFQ_DROP);</span>
    }
    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad5ff0cdaf314807a4b4747e4e0085c71"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::pkt_decapsulate" ref="ad5ff0cdaf314807a4b4747e4e0085c71" args="(IPv4Datagram *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IPv4Datagram* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#ad5ff0cdaf314807a4b4747e4e0085c71">pkt_decapsulate</a> </td>
          <td>(</td>
          <td class="paramtype">IPv4Datagram *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00756">756</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{

    <span class="keywordflow">if</span> (p-&gt;getTransportProtocol() == IP_PROT_IP)
    {
        IPv4Datagram *datagram = check_and_cast  &lt;IPv4Datagram *&gt;(p-&gt;decapsulate());
        datagram-&gt;setTimeToLive(p-&gt;getTimeToLive());
        <span class="keyword">delete</span> p;
        <span class="keywordflow">return</span> datagram;
    }
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aad0b14ba05f9ee915178379bee41ab47"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::pkt_encapsulate" ref="aad0b14ba05f9ee915178379bee41ab47" args="(IPv4Datagram *p, IPv4Address gateway)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IPv4Datagram* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#aad0b14ba05f9ee915178379bee41ab47">pkt_encapsulate</a> </td>
          <td>(</td>
          <td class="paramtype">IPv4Datagram *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IPv4Address&#160;</td>
          <td class="paramname"><em>gateway</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00726">726</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    IPv4Datagram *datagram = <span class="keyword">new</span> IPv4Datagram(p-&gt;getName());
    datagram-&gt;setByteLength(IP_HEADER_BYTES);
    datagram-&gt;encapsulate(p);

    <span class="comment">// set source and destination address</span>
    datagram-&gt;setDestAddress(gateway);

    IPv4Address src = p-&gt;getSrcAddress();

    <span class="comment">// when source address was given, use it; otherwise it&#39;ll get the address</span>
    <span class="comment">// of the outgoing interface after routing</span>
    <span class="comment">// set other fields</span>
    datagram-&gt;setTypeOfService(p-&gt;getTypeOfService());
    datagram-&gt;setIdentification(p-&gt;getIdentification());
    datagram-&gt;setMoreFragments(<span class="keyword">false</span>);
    datagram-&gt;setDontFragment (p-&gt;getDontFragment());
    datagram-&gt;setFragmentOffset(0);
    datagram-&gt;setTimeToLive(
        p-&gt;getTimeToLive() &gt; 0 ?
        p-&gt;getTimeToLive() :
        0);

    datagram-&gt;setTransportProtocol(IP_PROT_IP);
    <span class="keywordflow">return</span> datagram;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a10b108f7dc7dc50e3af3457f4448cc65"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::processLinkBreak" ref="a10b108f7dc7dc50e3af3457f4448cc65" args="(const cPolymorphic *details)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a10b108f7dc7dc50e3af3457f4448cc65">processLinkBreak</a> </td>
          <td>(</td>
          <td class="paramtype">const cPolymorphic *&#160;</td>
          <td class="paramname"><em>details</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01086">1086</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    IPv4Datagram  *dgram=NULL;
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a>)
    {
        <span class="keywordflow">if</span> (dynamic_cast&lt;IPv4Datagram *&gt;(const_cast&lt;cPolymorphic*&gt; (details)))
        {
            dgram = check_and_cast&lt;IPv4Datagram *&gt;(details);
            <a class="code" href="NA__aodv__uu__omnet_8cc.html#ae281ab89be96795d96ef568ad395a7c5">packetFailed</a>(dgram);
            <span class="keywordflow">return</span>;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;Ieee80211DataFrame *&gt;(const_cast&lt;cPolymorphic*&gt; (details)))
        {
            Ieee80211DataFrame *frame = <span class="keyword">dynamic_cast&lt;</span>Ieee80211DataFrame *<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span>cPolymorphic*<span class="keyword">&gt;</span>(details));
            <a class="code" href="NA__aodv__uu__omnet_8cc.html#a719e65d72818a3b33a6178fad4a13821">packetFailedMac</a>(frame);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1f27f26ef21c3d67952b82bb3a400326"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::processPacket" ref="a1f27f26ef21c3d67952b82bb3a400326" args="(IPv4Datagram *p, unsigned int ifindex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a1f27f26ef21c3d67952b82bb3a400326">processPacket</a> </td>
          <td>(</td>
          <td class="paramtype">IPv4Datagram *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ifindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00901">901</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structrt__table.html">rt_table_t</a> *fwd_rt, *rev_rt;
    <span class="keyword">struct </span>in_addr dest_addr, src_addr;
    u_int8_t rreq_flags = 0;
    <span class="keyword">struct </span><a class="code" href="structip__data.html">ip_data</a> *ipd = NULL;


    fwd_rt = NULL;      <span class="comment">/* For broadcast we provide no next hop */</span>
    ipd = NULL;         <span class="comment">/* No ICMP messaging */</span>

    <span class="keywordtype">bool</span> isLocal=<span class="keyword">true</span>;

    src_addr.s_addr = ManetAddress(p-&gt;getSrcAddress());
    dest_addr.s_addr = ManetAddress(p-&gt;getDestAddress());

    InterfaceEntry *   ie;

    <span class="keywordflow">if</span> (!p-&gt;getSrcAddress().isUnspecified())
    {
        isLocal = isLocalAddress(ManetAddress(p-&gt;getSrcAddress()));
    }

    ie = getInterfaceEntry (ifindex);
    <span class="keywordflow">if</span> (p-&gt;getTransportProtocol()==IP_PROT_TCP)
        rreq_flags |= <a class="code" href="NA__aodv__rreq_8h.html#a064b5e5007e297023c926e9c08a83fe6">RREQ_GRATUITOUS</a>;

    <span class="comment">/* If this is a TCP packet and we don&#39;t have a route, we should</span>
<span class="comment">       set the gratuituos flag in the RREQ. */</span>
    <span class="keywordtype">bool</span> isMcast = ie-&gt;ipv4Data()-&gt;isMemberOfMulticastGroup(dest_addr.s_addr.getIPv4());

    <span class="comment">/* If the packet is not interesting we just let it go through... */</span>
    <span class="keywordflow">if</span> (isMcast || dest_addr.s_addr == ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>)))
    {
        send(p,<span class="stringliteral">&quot;to_ip&quot;</span>);
        <span class="keywordflow">return</span>;
    }
    <span class="comment">/* Find the entry of the neighboring node and the destination  (if any). */</span>
    rev_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(src_addr);
    fwd_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(dest_addr);

<span class="preprocessor">#ifdef CONFIG_GATEWAY</span>
<span class="preprocessor"></span>    <span class="comment">/* Check if we have a route and it is an Internet destination (Should be</span>
<span class="comment">     * encapsulated and routed through the gateway). */</span>
    <span class="keywordflow">if</span> (fwd_rt &amp;&amp; (fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>) &amp;&amp;
            (fwd_rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>))
    {
        <span class="comment">/* The destination should be relayed through the IG */</span>

        <a class="code" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a>(fwd_rt, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);

        p = <a class="code" href="NA__aodv__uu__omnet_8cc.html#aad0b14ba05f9ee915178379bee41ab47">pkt_encapsulate</a>(p, *gateWayAddress);

        <span class="keywordflow">if</span> (p == NULL)
        {
            <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_ERR, 0, <span class="stringliteral">&quot;IP Encapsulation failed!&quot;</span>);
            <span class="keywordflow">return</span>;
        }
        <span class="comment">/* Update pointers to headers */</span>
        dest_addr.s_addr = gateWayAddress-&gt;getInt();
        fwd_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(dest_addr);
    }
<span class="preprocessor">#endif </span><span class="comment">/* CONFIG_GATEWAY */</span>

    <span class="comment">/* UPDATE TIMERS on active forward and reverse routes...  */</span>
    <a class="code" href="NA__routing__table_8cc.html#a438604d7812eff676f0273d700177bc8">rt_table_update_route_timeouts</a>(fwd_rt, rev_rt);

    <span class="comment">/* OK, the timeouts have been updated. Now see if either: 1. The</span>
<span class="comment">       packet is for this node -&gt; ACCEPT. 2. The packet is not for this</span>
<span class="comment">       node -&gt; Send RERR (someone want&#39;s this node to forward packets</span>
<span class="comment">       although there is no route) or Send RREQ. */</span>

    <span class="keywordflow">if</span> (!fwd_rt || fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a> ||
            (fwd_rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> == 1 &amp;&amp; (fwd_rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#adcb78e3d580f80f48cb665c2cbc5c99b">RT_UNIDIR</a>)))
    {

        <span class="comment">/* Check if the route is marked for repair or is INVALID. In</span>
<span class="comment">         * that case, do a route discovery. */</span>
        <span class="keyword">struct </span>in_addr rerr_dest;

        <span class="comment">// BEGIN NA_SINKHOLE - sancale</span>
        <span class="comment">// If the sinkhole does not know the route, it does not send RERR</span>
        <span class="keywordflow">if</span> (sinkholeAttackIsActive) {
            <span class="keywordflow">if</span> (sinkOnlyWhenRouteInTable == <span class="keyword">false</span>) {
                <a class="code" href="NA__NesgLog_8h.html#a159ca84d25a5487d8e81e4438725df19" title="LOG macro.">LOG</a> &lt;&lt; <span class="stringliteral">&quot;Sinkhole does not send RERR&quot;</span> &lt;&lt; endl;
                cout &lt;&lt; simTime() &lt;&lt; <span class="stringliteral">&quot;: Sinkhole does not send RERR &quot;</span> &lt;&lt; endl;
                <span class="keyword">delete</span> p;
                <span class="keywordflow">return</span>;
            }
        }
        <span class="comment">// END NA_SINKHOLE - sancale</span>

        <span class="keywordflow">if</span> (isLocal)
            <span class="keywordflow">goto</span> route_discovery;

        <span class="keywordflow">if</span> (fwd_rt &amp;&amp; (fwd_rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>))
            <span class="keywordflow">goto</span> route_discovery;



        <a class="code" href="structRERR.html">RERR</a> *rerr;
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0,
              <span class="stringliteral">&quot;No route, src=%s dest=%s prev_hop=%s - DROPPING!&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(src_addr), <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest_addr));
        <span class="keywordflow">if</span> (fwd_rt)
        {
            rerr = <a class="code" href="NA__aodv__rerr_8cc.html#a5be9893b4384b027d89d7349d69fe6f4">rerr_create</a>(0, fwd_rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>,fwd_rt-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a>);
            <a class="code" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a>(fwd_rt, <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);
        }
        <span class="keywordflow">else</span>
            rerr = <a class="code" href="NA__aodv__rerr_8cc.html#a5be9893b4384b027d89d7349d69fe6f4">rerr_create</a>(0, dest_addr, 0);
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Sending RERR to prev hop %s for unknown dest %s&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(src_addr), <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest_addr));

        <span class="comment">/* Unicast the RERR to the source of the data transmission</span>
<span class="comment">         * if possible, otherwise we broadcast it. */</span>

        <span class="keywordflow">if</span> (rev_rt &amp;&amp; rev_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
            rerr_dest = rev_rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>;
        <span class="keywordflow">else</span>
            rerr_dest.s_addr = ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>));

        <a class="code" href="NA__aodv__socket_8cc.html#a40fde4bce5dbf653ef027116bcca0e7b">aodv_socket_send</a>((<a class="code" href="structAODV__msg.html">AODV_msg</a> *) rerr, rerr_dest,<a class="code" href="NA__aodv__rerr_8h.html#a1defe1de303abc4adadc9d0e0fb02720">RERR_CALC_SIZE</a>(rerr),
                         1, &amp;<a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(ifindex));
        <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a>)
        {
            <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Wait on reboot timer reset.&quot;</span>);
            <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;<a class="code" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a>, <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);
        }

        <span class="comment">//drop (p);</span>
        sendICMP(p);
        <span class="comment">/* DEBUG(LOG_DEBUG, 0, &quot;Dropping pkt uid=%d&quot;, ch-&gt;uid()); */</span>
        <span class="comment">//  icmpAccess.get()-&gt;sendErrorMessage(p, ICMP_DESTINATION_UNREACHABLE, 0);</span>
        <span class="keywordflow">return</span>;

route_discovery:
        <span class="comment">/* Buffer packets... Packets are queued by the ip_queue.o</span>
<span class="comment">           module already. We only need to save the handle id, and</span>
<span class="comment">           return the proper verdict when we know what to do... */</span>

        <a class="code" href="NA__packet__queue__omnet_8cc.html#abca7137accdfd65a117cc2df8a1cec70">packet_queue_add</a>(p, dest_addr);

        <span class="keywordflow">if</span> (fwd_rt &amp;&amp; (fwd_rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>))
            <a class="code" href="NA__aodv__rreq_8cc.html#a44f18f90d4862d93f99c2b197ba61fa3">rreq_local_repair</a>(fwd_rt, src_addr, ipd);
        <span class="keywordflow">else</span>
            <a class="code" href="NA__aodv__rreq_8cc.html#acd5f5a4e8e1989bcf8b4612642c126a9">rreq_route_discovery</a>(dest_addr, rreq_flags, ipd);

        <span class="keywordflow">return</span>;

    }
    <span class="keywordflow">else</span>
    {
        <span class="comment">/* DEBUG(LOG_DEBUG, 0, &quot;Sending pkt uid=%d&quot;, ch-&gt;uid()); */</span>
        send(p,<span class="stringliteral">&quot;to_ip&quot;</span>);
        <span class="comment">/* When forwarding data, make sure we are sending HELLO messages */</span>
        gettimeofday(&amp;<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#a0685a8df41c78308172736070f16bcfa">fwd_time</a>, NULL);

        <span class="keywordflow">if</span> (!<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> &amp;&amp; <a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a>)
            <a class="code" href="NA__aodv__hello_8cc.html#ab6bcab8fcfe60a3dfdb059c4f96c402b">hello_start</a>();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8cb8c2e2b22e66445f91073114decaf8"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::recvAODVUUPacket" ref="a8cb8c2e2b22e66445f91073114decaf8" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a8cb8c2e2b22e66445f91073114decaf8">recvAODVUUPacket</a> </td>
          <td>(</td>
          <td class="paramtype">cMessage *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00841">841</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>in_addr src, dst;
    <span class="keywordtype">int</span> ttl;
    <span class="keywordtype">int</span> interfaceId;

    <a class="code" href="structAODV__msg.html">AODV_msg</a> *aodv_msg = check_and_cast&lt;<a class="code" href="structAODV__msg.html">AODV_msg</a> *&gt; (msg);
    <span class="keywordtype">int</span> len = aodv_msg-&gt;getByteLength();
    <span class="keywordtype">int</span> ifIndex=NS_IFINDEX;

    ttl =  aodv_msg-&gt;<a class="code" href="structAODV__msg.html#a14556cf0f421518fc2e073d4ba23ca25">ttl</a>-1;
    <span class="keywordflow">if</span> (!isInMacLayer())
    {
        IPv4ControlInfo *ctrl = check_and_cast&lt;IPv4ControlInfo *&gt;(msg-&gt;getControlInfo());
        IPvXAddress srcAddr = ctrl-&gt;getSrcAddr();
        IPvXAddress destAddr = ctrl-&gt;getDestAddr();

        src.s_addr = ManetAddress(srcAddr);
        dst.s_addr =  ManetAddress(destAddr);
        interfaceId = ctrl-&gt;getInterfaceId();

    }
    <span class="keywordflow">else</span>
    {
        Ieee802Ctrl *ctrl = check_and_cast&lt;Ieee802Ctrl *&gt;(msg-&gt;getControlInfo());
        src.s_addr = ManetAddress(ctrl-&gt;getSrc());
        dst.s_addr =  ManetAddress(ctrl-&gt;getDest());
    }

    InterfaceEntry *   ie;
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; getNumWlanInterfaces(); i++)
    {
        ie = getWlanInterfaceEntry(i);
        <span class="keywordflow">if</span> (!isInMacLayer())
        {
            IPv4InterfaceData *ipv4data = ie-&gt;ipv4Data();
            <span class="keywordflow">if</span> (interfaceId ==ie-&gt;getInterfaceId())
                ifIndex=getWlanInterfaceIndex(i);

            <span class="keywordflow">if</span> (ManetAddress(ipv4data-&gt;getIPAddress()) == src.s_addr)
            {
                <span class="keyword">delete</span>   aodv_msg;
                <span class="keywordflow">return</span>;
            }
        }
        <span class="keywordflow">else</span>
        {
            ManetAddress add(ie-&gt;getMacAddress());
            <span class="keywordflow">if</span> (add== src.s_addr)
            {
                <span class="keyword">delete</span>   aodv_msg;
                <span class="keywordflow">return</span>;
            }
        }
    }
    <a class="code" href="NA__aodv__socket_8cc.html#af59302e6c2e2f42307dd63ec3a56d4bd">aodv_socket_process_packet</a>(aodv_msg, len, src, dst, ttl, ifIndex);
    <span class="keyword">delete</span>   aodv_msg;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a729fbf9488031301b67264c1531da6a5"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::scheduleNextEvent" ref="a729fbf9488031301b67264c1531da6a5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00777">777</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    simtime_t <a class="code" href="structtimer.html">timer</a>;
    simtime_t timeout = <a class="code" href="NA__timer__queue__aodv_8cc.html#a07af83c3d8ae6d413f20d06e28a0d10f">timer_age_queue</a>();

    <span class="keywordflow">if</span> (!aodvTimerMap.empty())
    {
        timer = aodvTimerMap.begin()-&gt;first;
        <span class="keywordflow">if</span> (sendMessageEvent-&gt;isScheduled())
        {
            <span class="keywordflow">if</span> (<a class="code" href="structtimer.html">timer &lt; sendMessageEvent-&gt;</a>getArrivalTime())
            {
                cancelEvent(sendMessageEvent);
                scheduleAt(timer, sendMessageEvent);
            }
        }
        <span class="keywordflow">else</span>
        {
            scheduleAt(timer, sendMessageEvent);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a877aca5e8d2deb5b3ed4a3b14bde93ca"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::setRefreshRoute" ref="a877aca5e8d2deb5b3ed4a3b14bde93ca" args="(const ManetAddress &amp;destination, const ManetAddress &amp;nextHop, bool isReverse)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a877aca5e8d2deb5b3ed4a3b14bde93ca">setRefreshRoute</a> </td>
          <td>(</td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>nextHop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isReverse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01172">1172</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>in_addr dest_addr, next_hop;
    dest_addr.s_addr = destination;
    next_hop.s_addr = nextHop;
    <a class="code" href="structrt__table.html">rt_table_t</a> * route  = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(dest_addr);

    <span class="keywordflow">if</span>(par (<span class="stringliteral">&quot;checkNextHop&quot;</span>).boolValue())
    {
        <span class="keywordflow">if</span> (nextHop.isUnspecified())
           <span class="keywordflow">return</span>;
        <span class="keywordflow">if</span> (!isReverse)
        {
            <span class="keywordflow">if</span> (route &amp;&amp;(route-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr==nextHop))
                 <a class="code" href="NA__routing__table_8cc.html#a438604d7812eff676f0273d700177bc8">rt_table_update_route_timeouts</a>(route, NULL);
        }


        <span class="keywordflow">if</span> (isReverse &amp;&amp; !route)
        {
            <span class="comment">// Gratuitous Return Path</span>
            <span class="keyword">struct </span>in_addr <a class="code" href="utilidades_8cc.html#a4a1ba98aad33712bb6059e7857256a78">node_addr</a>;
            <span class="keyword">struct </span>in_addr  ip_src;
            <a class="code" href="utilidades_8cc.html#a4a1ba98aad33712bb6059e7857256a78">node_addr</a>.s_addr = destination;
            ip_src.s_addr = nextHop;
            <a class="code" href="NA__routing__table_8cc.html#aa2ab023febf342ee9ac01a344ebd4e50">rt_table_insert</a>(<a class="code" href="utilidades_8cc.html#a4a1ba98aad33712bb6059e7857256a78">node_addr</a>, ip_src,0,0, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>, <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>, 0,NS_DEV_NR,0xFFFFFFF,100);
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (route &amp;&amp; (route-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr==nextHop))
            <a class="code" href="NA__routing__table_8cc.html#a438604d7812eff676f0273d700177bc8">rt_table_update_route_timeouts</a>(NULL, route);

    }
    <span class="keywordflow">else</span>
    {
        <span class="keywordflow">if</span> (!isReverse)
        {
            <span class="keywordflow">if</span> (route)
                 <a class="code" href="NA__routing__table_8cc.html#a438604d7812eff676f0273d700177bc8">rt_table_update_route_timeouts</a>(route, NULL);
        }


        <span class="keywordflow">if</span> (isReverse &amp;&amp; !route &amp;&amp; !nextHop.isUnspecified())
        {
            <span class="comment">// Gratuitous Return Path</span>
            <span class="keyword">struct </span>in_addr <a class="code" href="utilidades_8cc.html#a4a1ba98aad33712bb6059e7857256a78">node_addr</a>;
            <span class="keyword">struct </span>in_addr  ip_src;
            <a class="code" href="utilidades_8cc.html#a4a1ba98aad33712bb6059e7857256a78">node_addr</a>.s_addr = destination;
            ip_src.s_addr = nextHop;
            <a class="code" href="NA__routing__table_8cc.html#aa2ab023febf342ee9ac01a344ebd4e50">rt_table_insert</a>(<a class="code" href="utilidades_8cc.html#a4a1ba98aad33712bb6059e7857256a78">node_addr</a>, ip_src,0,0, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>, <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>, 0,NS_DEV_NR,0xFFFFFFF,100);
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (route)
            <a class="code" href="NA__routing__table_8cc.html#a438604d7812eff676f0273d700177bc8">rt_table_update_route_timeouts</a>(NULL, route);

    }

    Enter_Method_Silent();
    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a02b4c17f3b5f244a29321bf62e72fe66"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::setRoute" ref="a02b4c17f3b5f244a29321bf62e72fe66" args="(const ManetAddress &amp;dest, const ManetAddress &amp;add, const int &amp;ifaceIndex, const int &amp;hops, const ManetAddress &amp;mask)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a2638e88e0ea331164577605d09171491">setRoute</a> </td>
          <td>(</td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>ifaceIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>hops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01249">1249</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method_Silent();
    <span class="keyword">struct </span>in_addr destAddr;
    <span class="keyword">struct </span>in_addr nextAddr;
    <span class="keyword">struct </span>in_addr rerr_dest;
    destAddr.s_addr = dest;
    nextAddr.s_addr = add;
    <span class="keywordtype">bool</span> status=<span class="keyword">true</span>;
    <span class="keywordtype">bool</span> delEntry = add.isUnspecified();

    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;setRoute %s next hop %s&quot;</span>,<a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(destAddr),<a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(nextAddr));

    <a class="code" href="structrt__table.html">rt_table_t</a> * fwd_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(destAddr);

    <span class="keywordflow">if</span> (fwd_rt)
    {
        <span class="keywordflow">if</span> (delEntry)
        {
            <a class="code" href="structRERR.html">RERR</a>* rerr = <a class="code" href="NA__aodv__rerr_8cc.html#a5be9893b4384b027d89d7349d69fe6f4">rerr_create</a>(0, destAddr, 0);
            <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;setRoute Sending for unknown dest %s&quot;</span>, <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(destAddr));

            <span class="comment">/* Unicast the RERR to the source of the data transmission</span>
<span class="comment">             * if possible, otherwise we broadcast it. */</span>
            rerr_dest.s_addr = ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>));

            <a class="code" href="NA__aodv__socket_8cc.html#a40fde4bce5dbf653ef027116bcca0e7b">aodv_socket_send</a>((<a class="code" href="structAODV__msg.html">AODV_msg</a> *) rerr, rerr_dest,<a class="code" href="NA__aodv__rerr_8h.html#a1defe1de303abc4adadc9d0e0fb02720">RERR_CALC_SIZE</a>(rerr),
                             1, &amp;<a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(NS_IFINDEX));
        }
        ManetAddress dest = fwd_rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr;
        AodvRtTableMap::iterator it = aodvRtTableMap.find(dest);
        <span class="keywordflow">if</span> (it != aodvRtTableMap.end())
        {
            <span class="keywordflow">if</span> (it-&gt;second != fwd_rt)
                opp_error(<span class="stringliteral">&quot;AODV routing table error&quot;</span>);
        }
        aodvRtTableMap.erase(it);
        <span class="keywordflow">if</span> (fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> || fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
            <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>--;
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;fwd_rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;fwd_rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;fwd_rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);
        <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a> = aodvRtTableMap.size();
        free (fwd_rt);
    }
    <span class="keywordflow">else</span>
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;No route entry to delete&quot;</span>);

    <span class="keywordflow">if</span> (ifaceIndex&gt;=getNumInterfaces())
        status = <span class="keyword">false</span>;
    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a02b4c17f3b5f244a29321bf62e72fe66">ManetRoutingBase::setRoute</a>(dest,add,ifaceIndex,hops,mask);

    <span class="keywordflow">if</span> (!delEntry &amp;&amp; ifaceIndex&lt;getNumInterfaces())
    {
        fwd_rt = <a class="code" href="NA__routing__table_8cc.html#ac1648cf2755eba3487d843755d0bd653">modifyAODVTables</a>(destAddr,nextAddr,hops,(uint32_t) SIMTIME_DBL(simTime()), 0xFFFF,<a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>,0, ifaceIndex);
        status = (fwd_rt!=NULL);

    }

    <span class="keywordflow">return</span> status;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2638e88e0ea331164577605d09171491"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::setRoute" ref="a2638e88e0ea331164577605d09171491" args="(const ManetAddress &amp;dest, const ManetAddress &amp;add, const char *ifaceName, const int &amp;hops, const ManetAddress &amp;mask)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#a2638e88e0ea331164577605d09171491">setRoute</a> </td>
          <td>(</td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ifaceName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>hops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ManetAddress &amp;&#160;</td>
          <td class="paramname"><em>mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l01312">1312</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    Enter_Method_Silent();
    <span class="keyword">struct </span>in_addr destAddr;
    <span class="keyword">struct </span>in_addr nextAddr;
    <span class="keyword">struct </span>in_addr rerr_dest;
    destAddr.s_addr = dest;
    nextAddr.s_addr = add;
    <span class="keywordtype">bool</span> status=<span class="keyword">true</span>;
    <span class="keywordtype">int</span> index;
    <span class="keywordtype">bool</span> delEntry = add.isUnspecified();

    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;setRoute %s next hop %s&quot;</span>,<a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(destAddr),<a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(nextAddr));
    <a class="code" href="structrt__table.html">rt_table_t</a> * fwd_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(destAddr);

    <span class="keywordflow">if</span> (fwd_rt)
    {
        <span class="keywordflow">if</span> (delEntry)
        {
            <a class="code" href="structRERR.html">RERR</a>* rerr = <a class="code" href="NA__aodv__rerr_8cc.html#a5be9893b4384b027d89d7349d69fe6f4">rerr_create</a>(0, destAddr, 0);
            <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;setRoute Sending for unknown dest %s&quot;</span>, <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(destAddr));

            <span class="comment">/* Unicast the RERR to the source of the data transmission</span>
<span class="comment">             * if possible, otherwise we broadcast it. */</span>
            rerr_dest.s_addr = ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>));

            <a class="code" href="NA__aodv__socket_8cc.html#a40fde4bce5dbf653ef027116bcca0e7b">aodv_socket_send</a>((<a class="code" href="structAODV__msg.html">AODV_msg</a> *) rerr, rerr_dest,<a class="code" href="NA__aodv__rerr_8h.html#a1defe1de303abc4adadc9d0e0fb02720">RERR_CALC_SIZE</a>(rerr),
                             1, &amp;<a class="code" href="NA__defs__aodv_8h.html#a3ec95f4497670c4d0d407cbf59b5f0a5">DEV_IFINDEX</a>(NS_IFINDEX));
        }
        ManetAddress dest = fwd_rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr;
        AodvRtTableMap::iterator it = aodvRtTableMap.find(dest);
        <span class="keywordflow">if</span> (it != aodvRtTableMap.end())
        {
            <span class="keywordflow">if</span> (it-&gt;second != fwd_rt)
                opp_error(<span class="stringliteral">&quot;AODV routing table error&quot;</span>);
        }
        aodvRtTableMap.erase(it);
        <span class="keywordflow">if</span> (fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> || fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
            <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>--;
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;fwd_rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;fwd_rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;fwd_rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);
        <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a> = aodvRtTableMap.size();
        free (fwd_rt);
    }
    <span class="keywordflow">else</span>
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;No route entry to delete&quot;</span>);

    <span class="keywordflow">for</span> (index = 0; index &lt;getNumInterfaces(); index++)
    {
        <span class="keywordflow">if</span> (strcmp(ifaceName, getInterfaceEntry(index)-&gt;<a class="code" href="utilidades_8cc.html#af5b5c4787ffe48b5c4fc01aea42cd1c4">getName</a>())==0) <span class="keywordflow">break</span>;
    }
    <span class="keywordflow">if</span> (index&gt;=getNumInterfaces())
        status = <span class="keyword">false</span>;

    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a02b4c17f3b5f244a29321bf62e72fe66">ManetRoutingBase::setRoute</a>(dest,add,index,hops,mask);

    <span class="keywordflow">if</span> (!delEntry &amp;&amp; index&lt;getNumInterfaces())
    {
        fwd_rt = <a class="code" href="NA__routing__table_8cc.html#ac1648cf2755eba3487d843755d0bd653">modifyAODVTables</a>(destAddr,nextAddr,hops,(uint32_t) SIMTIME_DBL(simTime()), 0xFFFF,<a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>,0, index);
        status = (fwd_rt!=NULL);
    }


    <span class="keywordflow">return</span> status;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac2022163ffdaa951d130a0aba7881552"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::startAODVUUAgent" ref="ac2022163ffdaa951d130a0aba7881552" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__aodv__uu__omnet_8cc.html#ac2022163ffdaa951d130a0aba7881552">startAODVUUAgent</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00677">677</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{

    <span class="comment">/* Set up the wait-on-reboot timer */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a>)
    {
        <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;<a class="code" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a>, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#a5ed6c5e23736c182228b2b5c3382c5ad">wait_on_reboot_timeout</a>, &amp;<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;<a class="code" href="main_8c.html#a102638bbe37dfc0788ddc7de6afbffe5">worb_timer</a>, <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_NOTICE, 0, <span class="stringliteral">&quot;In wait on reboot for %d milliseconds.&quot;</span>,<a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);
    }
    <span class="comment">/* Schedule the first HELLO */</span>
    <span class="keywordflow">if</span> (!<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> &amp;&amp; !<a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a>)
        <a class="code" href="NA__aodv__hello_8cc.html#ab6bcab8fcfe60a3dfdb059c4f96c402b">hello_start</a>();

    <span class="comment">/* Initialize routing table logging */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a>)
        <a class="code" href="NA__debug__aodv_8cc.html#ad648b58f4087c21b60e97762f4d87bf8">log_rt_table_init</a>();

    <span class="comment">/* Initialization complete */</span>
    initialized = 1;

    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Routing agent with IP = %s  started.&quot;</span>,
          <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(NS_DEV_NR).ipaddr));

    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Settings:&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;unidir_hack %s&quot;</span>, <a class="code" href="main_8c.html#ae55eec632e369a4afc18e804bae8f3e4">unidir_hack</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;rreq_gratuitous %s&quot;</span>, <a class="code" href="main_8c.html#a9114356a8b6ad57f39c4d50388776531">rreq_gratuitous</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;expanding_ring_search %s&quot;</span>, <a class="code" href="main_8c.html#a09464654a5c100dc4840caefec4672b0">expanding_ring_search</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;local_repair %s&quot;</span>, <a class="code" href="main_8c.html#ab289d12fed7e29d1431a3206d813170c">local_repair</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;receive_n_hellos %s&quot;</span>, <a class="code" href="main_8c.html#aa10c5b3c1ff250cd241fe589fdf92253">receive_n_hellos</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;hello_jittering %s&quot;</span>, <a class="code" href="main_8c.html#a5195b41adb4586d2ad897d08ebb3dfad">hello_jittering</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;wait_on_reboot %s&quot;</span>, <a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;optimized_hellos %s&quot;</span>, <a class="code" href="main_8c.html#aff2e4196aa2a66f42a9688b5dde5cbd8">optimized_hellos</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;ratelimit %s&quot;</span>, <a class="code" href="main_8c.html#a3ecfcf4b066b9c242e176393695e38d0">ratelimit</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;llfeedback %s&quot;</span>, <a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;internet_gw_mode %s&quot;</span>, <a class="code" href="main_8c.html#a6be52079b3b26f9986ccdddfbca964e6">internet_gw_mode</a> ? <span class="stringliteral">&quot;ON&quot;</span> : <span class="stringliteral">&quot;OFF&quot;</span>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;ACTIVE_ROUTE_TIMEOUT=%d&quot;</span>, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;TTL_START=%d&quot;</span>, <a class="code" href="NA__params_8h.html#a25ab47cb76166dd649dfb39459efa2a8">TTL_START</a>);
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;DELETE_PERIOD=%d&quot;</span>, <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);

    <span class="comment">/* Schedule the first timeout */</span>
    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a729fbf9488031301b67264c1531da6a5">scheduleNextEvent</a>();
    <span class="keywordflow">return</span> 0;

}
</pre></div>
</div>
</div>
<a class="anchor" id="ac64c0a26a140522ebd7d60272535e71f"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::~NA_AODVUU" ref="ac64c0a26a140522ebd7d60272535e71f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> ~<a class="el" href="classNA__AODVUU.html">NA_AODVUU</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00274">274</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structlist__t.html">list_t</a> *tmp = NULL, *pos = NULL;
<span class="preprocessor">#ifdef AODV_USE_STL_RT</span>
<span class="preprocessor"></span>    <span class="keywordflow">while</span> (!aodvRtTableMap.empty())
    {
        free (aodvRtTableMap.begin()-&gt;second);
        aodvRtTableMap.erase(aodvRtTableMap.begin());
    }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="NA__routing__table_8h.html#a372eb877536fc42dec7273e7e5682589">RT_TABLESIZE</a>; i++)
    {
        <a class="code" href="NA__list_8h.html#af15e2de3344d7da69bb2620b6f92a879">list_foreach_safe</a>(pos, tmp, &amp;<a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a9342dc0960c9521d5fdd827890d3c31f">tbl</a>[i])
        {
            <a class="code" href="structrt__table.html">rt_table_t</a> *rt = (<a class="code" href="structrt__table.html">rt_table_t</a> *) pos;
            <a class="code" href="NA__list_8cc.html#a95fe3a213ff2c475c79bd705a56a22cc">list_detach</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a9766df03900778ed6369aad09aeb7d43">l</a>);
            <a class="code" href="NA__routing__table_8cc.html#a01a24c260d1ec566bcae0dc82d3867cf">precursor_list_destroy</a>(rt);
            free(rt);
        }
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#ifndef AODV_USE_STL</span>
<span class="preprocessor"></span>    <span class="keywordflow">while</span> (!<a class="code" href="NA__list_8cc.html#a25097023f865b93f40baef7477fa0331">list_empty</a>(&amp;rreq_records))
    {
        pos = <a class="code" href="NA__list_8cc.html#a0d55f2deea617b57a6ee65085fe5f840">list_first</a>(&amp;rreq_records);
        <a class="code" href="NA__list_8cc.html#a95fe3a213ff2c475c79bd705a56a22cc">list_detach</a>(pos);
        <span class="keywordflow">if</span> (pos) free(pos);
    }

    <span class="keywordflow">while</span> (!<a class="code" href="NA__list_8cc.html#a25097023f865b93f40baef7477fa0331">list_empty</a>(&amp;rreq_blacklist))
    {
        pos = <a class="code" href="NA__list_8cc.html#a0d55f2deea617b57a6ee65085fe5f840">list_first</a>(&amp;rreq_blacklist);
        <a class="code" href="NA__list_8cc.html#a95fe3a213ff2c475c79bd705a56a22cc">list_detach</a>(pos);
        <span class="keywordflow">if</span> (pos) free(pos);
    }

    <span class="keywordflow">while</span> (!<a class="code" href="NA__list_8cc.html#a25097023f865b93f40baef7477fa0331">list_empty</a>(&amp;seekhead))
    {
        pos = <a class="code" href="NA__list_8cc.html#a0d55f2deea617b57a6ee65085fe5f840">list_first</a>(&amp;seekhead);
        <a class="code" href="NA__list_8cc.html#a95fe3a213ff2c475c79bd705a56a22cc">list_detach</a>(pos);
        <span class="keywordflow">if</span> (pos) free(pos);
    }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <span class="keywordflow">while</span> (!rreq_records.empty())
    {
        free (rreq_records.back());
        rreq_records.pop_back();
    }

    <span class="keywordflow">while</span> (!rreq_blacklist.empty())
    {
        free (rreq_blacklist.begin()-&gt;second);
        rreq_blacklist.erase(rreq_blacklist.begin());
    }

    <span class="keywordflow">while</span> (!seekhead.empty())
    {
        <span class="keyword">delete</span> (seekhead.begin()-&gt;second);
        seekhead.erase(seekhead.begin());
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <a class="code" href="NA__packet__queue__omnet_8cc.html#a486418eea471861e6f0db62fb5344c5a">packet_queue_destroy</a>();
    cancelAndDelete(sendMessageEvent);
    <a class="code" href="NA__debug__aodv_8cc.html#ad7f2a4f9e2cabca7e32a3a29fdcd8a79">log_cleanup</a>();
    <span class="keyword">delete</span> gateWayAddress;
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aef334ff0aa0d9bd45ea8385f98a49805"></a><!-- doxytag: member="NA_aodv_uu_omnet.cc::UDP_HEADER_BYTES" ref="aef334ff0aa0d9bd45ea8385f98a49805" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="NA__aodv__uu__omnet_8cc.html#aef334ff0aa0d9bd45ea8385f98a49805">UDP_HEADER_BYTES</a> = 8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__uu__omnet_8cc_source.html#l00055">55</a> of file <a class="el" href="NA__aodv__uu__omnet_8cc_source.html">NA_aodv_uu_omnet.cc</a>.</p>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="NA__aodv__uu__omnet_8cc.html">NA_aodv_uu_omnet.cc</a>      </li>

    <li class="footer">Generated on Fri Oct 18 2013 20:34:56 for NETWORK ATTACKS FRAMEWORK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>

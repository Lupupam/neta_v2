<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NETWORK ATTACKS FRAMEWORK: NA_routing_table.cc File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">NETWORK ATTACKS FRAMEWORK
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A NETwork Attacks framework. Making network attacks impact evaluation easier!</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('NA__routing__table_8cc.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">NA_routing_table.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;time.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="NA__aodv__uu__omnet_8h_source.html">../NA_aodv_uu_omnet.h</a>&quot;</code><br/>
</div>
<p><a href="NA__routing__table_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a91e53e3b4f7c1455ebbe969f8a2cc9d6">NS_PORT</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a661b55933ece098127ebc60554ffb304">OMNETPP</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#af55d0c061f4060fa7df11209b4b0fdbf">rt_table_init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a2b6110c0c2317c78736dc9668e792928">rt_table_destroy</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#aa2ab023febf342ee9ac01a344ebd4e50">rt_table_insert</a> (struct in_addr dest_addr, struct in_addr next, u_int8_t hops, u_int32_t seqno, u_int32_t life, u_int8_t state, u_int16_t flags, unsigned int ifindex, uint32_t cost, uint8_t hopfix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a> (struct in_addr dest_addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a84be5cffcb9a8b8449732a061f49515b">rt_table_find_gateway</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a155b5e815f7e4be905b3a357f94db03a">rt_table_invalidate</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#ad25951a4f27cfba6e1148b6c12d3c0c5">rt_table_delete</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#aab5332ef0b322b015adabb82041c5f8e">precursor_add</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rt, struct in_addr addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#abafb04a73e0ce98d4d7f01130f9e7f3e">precursor_remove</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rt, struct in_addr addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#ac1648cf2755eba3487d843755d0bd653">modifyAODVTables</a> (struct in_addr dest_addr, struct in_addr next, u_int8_t hops, u_int32_t seqno, u_int32_t life, u_int8_t state, u_int16_t flags, unsigned int ifindex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a01a24c260d1ec566bcae0dc82d3867cf">precursor_list_destroy</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a30f5595aef61223fe39fa39ebe85126e">rt_table_update</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rt, struct in_addr next, u_int8_t hops, u_int32_t seqno, u_int32_t lifetime, u_int8_t state, u_int16_t flags, int iface, uint32_t cost, uint8_t hopfix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="NA__defs__aodv_8h.html#a8ee7d4d6f8ffcfc6786cf264af633000">NS_INLINE</a> <a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rt, u_int32_t lifetime)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__routing__table_8cc.html#a438604d7812eff676f0273d700177bc8">rt_table_update_route_timeouts</a> (<a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *fwd_rt, <a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *rev_rt)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a91e53e3b4f7c1455ebbe969f8a2cc9d6"></a><!-- doxytag: member="NA_routing_table.cc::NS_PORT" ref="a91e53e3b4f7c1455ebbe969f8a2cc9d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__timer__queue__aodv_8cc.html#a91e53e3b4f7c1455ebbe969f8a2cc9d6">NS_PORT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00022">22</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a661b55933ece098127ebc60554ffb304"></a><!-- doxytag: member="NA_routing_table.cc::OMNETPP" ref="a661b55933ece098127ebc60554ffb304" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__timer__queue__aodv_8cc.html#a661b55933ece098127ebc60554ffb304">OMNETPP</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00023">23</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac1648cf2755eba3487d843755d0bd653"></a><!-- doxytag: member="NA_routing_table.cc::modifyAODVTables" ref="ac1648cf2755eba3487d843755d0bd653" args="(struct in_addr dest_addr, struct in_addr next, u_int8_t hops, u_int32_t seqno, u_int32_t life, u_int8_t state, u_int16_t flags, unsigned int ifindex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a>* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a09753bbbfa3a724cb839b673c032bd2e">modifyAODVTables</a> </td>
          <td>(</td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>dest_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>hops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>seqno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>life</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ifindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00484">484</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{

    <a class="code" href="structrt__table.html">rt_table_t</a> *rt;
    <span class="keyword">struct </span>in_addr nm;
    nm.s_addr = ManetAddress::ZERO;

    ManetAddress dest = dest_addr.s_addr;

    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;modifyAODVTables&quot;</span>);
    <span class="comment">/* Check if we already have an entry for dest_addr */</span>

    <span class="keywordflow">if</span> ((rt = (<a class="code" href="structrt__table.html">rt_table_t</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="structrt__table.html">rt_table_t</a>))) == NULL)
    {
        fprintf(stderr, <span class="stringliteral">&quot;Malloc failed!\n&quot;</span>);
        exit(-1);
    }
    memset(rt, 0, <span class="keyword">sizeof</span>(<a class="code" href="structrt__table.html">rt_table_t</a>));
    rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a> = dest_addr;
    rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a> = next;
    rt-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a> = seqno;
    rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> = flags;
    rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> = hops;
    rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a> = ifindex;
    rt-&gt;<a class="code" href="structrt__table.html#a8af92751cb9668dc43302a4d7e58cbb2">hash</a> = 0;
    rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> = state;
    <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#a34ff12101d7e56bc8aa8df4df6f5a75a">route_expire_timeout</a>, rt);
    <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#aa91c042a583638a7ab960c2279ad84d3">rrep_ack_timeout</a>, rt);
    <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#af86c8096e8c93a3a961acd9033086bf2">hello_timeout</a>, rt);
    rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_sec = 0;
    rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_usec = 0;
    rt-&gt;<a class="code" href="structrt__table.html#a3b5a178d7185631d88704739b5e7cdfc">hello_cnt</a> = 0;
    rt-&gt;<a class="code" href="structrt__table.html#aa6936b6581e12bb654b598e0230818be">nprec</a> = 0;

    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;Inserting %s next hop %s&quot;</span>,<a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest_addr), <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(next));

    aodvRtTableMap.insert(std::make_pair(dest,rt));
    <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a> = (int) aodvRtTableMap.size();
    <span class="keywordflow">if</span> (state == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
    {

        <span class="keywordflow">if</span> (flags &amp; <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>)
        {
            rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#a8d72cd7c39f6285ef3833c7d6b236176">handler</a> = &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#ae2bea653769ce2d45c36c4a6a05f93c9">local_repair_timeout</a>;
            life = <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>;
        }
        <span class="keywordflow">else</span>
        {
            rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#a8d72cd7c39f6285ef3833c7d6b236176">handler</a> = &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#ab512fd09a083ac6bf97c28d3fec4ef8d">route_delete_timeout</a>;
            life = <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>;
        }
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>++;
    }
<span class="preprocessor">#ifdef CONFIG_GATEWAY_DISABLE</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a2f5558f39e9b2cc1b42058314ddc9878">RT_GATEWAY</a>)
        <a class="code" href="NA__routing__table_8h.html#a55e686098d9ce5ef3879252f2fe5c4ae">rt_table_update_inet_rt</a>(rt, life);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">//#ifdef NS_PORT</span>
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;New timer for %s, life=%d&quot;</span>,
          <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>), life);

    <span class="keywordflow">if</span> (life != 0)
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, life);
<span class="comment">//#endif</span>
    <span class="comment">/* In case there are buffered packets for this destination, we</span>
<span class="comment">     * send them on the new route. */</span>

    std::vector&lt;ManetAddress&gt; list;
    getListRelatedAp(dest_addr.s_addr, list);

    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; list.size(); i++)
    {
        <span class="keyword">struct </span>in_addr auxAaddr;
        auxAaddr.s_addr = list[i];
        <span class="keywordflow">if</span> ((rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> || rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>) &amp;&amp; <a class="code" href="NA__seek__list_8cc.html#ab7e457fac6a28c55e9d38ed10ad7f2c2">seek_list_remove</a>(<a class="code" href="NA__seek__list_8cc.html#ae26827bd74face659624808c4d7bd517">seek_list_find</a>(auxAaddr)))
        {
            <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>)
                <a class="code" href="NA__packet__queue__omnet_8cc.html#ae754d9d367c7cfb6a0acf34440bb9dfa">packet_queue_set_verdict</a>(auxAaddr, <a class="code" href="NA__packet__queue__omnet_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aacbe4f556779b82ed25d8097fdfc266c">PQ_ENC_SEND</a>);
            <span class="keywordflow">else</span>
                <a class="code" href="NA__packet__queue__omnet_8cc.html#ae754d9d367c7cfb6a0acf34440bb9dfa">packet_queue_set_verdict</a>(auxAaddr, <a class="code" href="NA__packet__queue__omnet_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a3a9b03cb66b2bad1d04fe80c22b94b5a">PQ_SEND</a>);
        }
    }
    <span class="keywordflow">if</span> ( state == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
    {
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
    }
    <span class="keywordflow">return</span> rt;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aab5332ef0b322b015adabb82041c5f8e"></a><!-- doxytag: member="NA_routing_table.cc::precursor_add" ref="aab5332ef0b322b015adabb82041c5f8e" args="(rt_table_t *rt, struct in_addr addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#aaefa18011aefa0692e49127cc99b21bf">precursor_add</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00447">447</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">/* Sanity check */</span>
    <span class="keywordflow">if</span> (!rt)
        <span class="keywordflow">return</span>;
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.size(); i++)
    {
        <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>[i].neighbor.s_addr == addr.s_addr)
            <span class="keywordflow">return</span>;
    }
    <a class="code" href="structprecursor.html">precursor_t</a> pr;
    pr.<a class="code" href="structprecursor.html#afc67329c006c8ba2e0f1ae4718d16cda">neighbor</a>.s_addr = addr.s_addr;
    rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.push_back(pr);
    rt-&gt;<a class="code" href="structrt__table.html#aa6936b6581e12bb654b598e0230818be">nprec</a> = (int)rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.size();
    <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a01a24c260d1ec566bcae0dc82d3867cf"></a><!-- doxytag: member="NA_routing_table.cc::precursor_list_destroy" ref="a01a24c260d1ec566bcae0dc82d3867cf" args="(rt_table_t *rt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__routing__table_8h.html#a01a24c260d1ec566bcae0dc82d3867cf">precursor_list_destroy</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00583">583</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">/* Sanity check */</span>
    <span class="keywordflow">if</span> (!rt)
        <span class="keywordflow">return</span>;
    rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.clear();
    rt-&gt;<a class="code" href="structrt__table.html#aa6936b6581e12bb654b598e0230818be">nprec</a>=0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abafb04a73e0ce98d4d7f01130f9e7f3e"></a><!-- doxytag: member="NA_routing_table.cc::precursor_remove" ref="abafb04a73e0ce98d4d7f01130f9e7f3e" args="(rt_table_t *rt, struct in_addr addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#af76c0c02002a2d113c5cb216cf5f6824">precursor_remove</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00468">468</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">/* Sanity check */</span>
    <span class="keywordflow">if</span> (!rt)
        <span class="keywordflow">return</span>;
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.size(); i++)
    {
        <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>[i].neighbor.s_addr == addr.s_addr)
        {
            rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.erase(rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.begin()+i);
            rt-&gt;<a class="code" href="structrt__table.html#aa6936b6581e12bb654b598e0230818be">nprec</a> = (int)rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.size();
            <span class="keywordflow">return</span>;
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad25951a4f27cfba6e1148b6c12d3c0c5"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_delete" ref="ad25951a4f27cfba6e1148b6c12d3c0c5" args="(rt_table_t *rt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a5124ded9e400d4b0036c6065aa9e6bd8">rt_table_delete</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00407">407</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (!rt)
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_ERR, 0, <span class="stringliteral">&quot;No route entry to delete&quot;</span>);
        <span class="keywordflow">return</span>;
    }

    ManetAddress dest = rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr;
    AodvRtTableMap::iterator it = aodvRtTableMap.find(dest);
    <span class="keywordflow">if</span> (it != aodvRtTableMap.end())
    {
        <span class="keywordflow">if</span> (it-&gt;second != rt)
            opp_error(<span class="stringliteral">&quot;AODV routing table error&quot;</span>);
    }
    aodvRtTableMap.erase(it);

    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> || rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
    {

        <span class="comment">/* delete route to omnet inet routing table ... */</span>
        <span class="comment">/* if delete is true fiels next, hops and mask are nor used */</span>
        <span class="keyword">struct </span>in_addr nm;
        nm.s_addr = ManetAddress(IPv4Address::ALLONES_ADDRESS);
        omnet_chg_rte(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, nm, 0,<span class="keyword">true</span>);
        <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>--;
    }
    <span class="comment">/* Make sure timers are removed... */</span>
    <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
    <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
    <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);
    <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a> = (int) aodvRtTableMap.size();
    free(rt);
    <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2b6110c0c2317c78736dc9668e792928"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_destroy" ref="a2b6110c0c2317c78736dc9668e792928" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a963df74669436f4ba5069bd1eabe6fb6">rt_table_destroy</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00066">66</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">while</span> (!aodvRtTableMap.empty())
    {
        <a class="code" href="NA__routing__table_8cc.html#ad25951a4f27cfba6e1148b6c12d3c0c5">rt_table_delete</a> (aodvRtTableMap.begin()-&gt;second);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a69302b8ba8b3ee7f9d6c43eacd4ee43c"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_find" ref="a69302b8ba8b3ee7f9d6c43eacd4ee43c" args="(struct in_addr dest_addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a>* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#ac151b13d72a1afd74dd8b953b96c4bde">rt_table_find</a> </td>
          <td>(</td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>dest_addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00222">222</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{

    <span class="keywordflow">if</span> (aodvRtTableMap.empty())
        <span class="keywordflow">return</span> NULL;

    <span class="comment">/* Check if we already have an entry for dest_addr */</span>
    AodvRtTableMap::iterator it = aodvRtTableMap.find(dest_addr.s_addr);

    <span class="keywordflow">if</span> (it != aodvRtTableMap.end())
        <span class="keywordflow">return</span> it-&gt;second;
    <span class="keywordflow">else</span>
    {
        ManetAddress apAdd;
        if (getAp(dest_addr.s_addr, apAdd))
        {
            it = aodvRtTableMap.find(apAdd);
            <span class="keywordflow">if</span> (it != aodvRtTableMap.end())
                <span class="keywordflow">return</span> it-&gt;second;
        }
        <span class="keywordflow">return</span> NULL;
    }
    <span class="keywordflow">return</span> NULL;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a84be5cffcb9a8b8449732a061f49515b"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_find_gateway" ref="a84be5cffcb9a8b8449732a061f49515b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a>* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a9017f595e8fe64f7a14da1dc38fd85f4">rt_table_find_gateway</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00247">247</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structrt__table.html">rt_table_t</a> *gw = NULL;
    <span class="keywordflow">for</span> (AodvRtTableMap::iterator it = aodvRtTableMap.begin(); it != aodvRtTableMap.end(); it++)
    {
        <a class="code" href="structrt__table.html">rt_table_t</a> *rt = it-&gt;second;
        <span class="keywordflow">if</span> ((rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a2f5558f39e9b2cc1b42058314ddc9878">RT_GATEWAY</a>) &amp;&amp; rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
        {
            <span class="keywordflow">if</span> (!gw || rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> &lt; gw-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>)
                gw = rt;
        }
    }
    <span class="keywordflow">return</span> gw;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af55d0c061f4060fa7df11209b4b0fdbf"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_init" ref="af55d0c061f4060fa7df11209b4b0fdbf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#afe6be2fd36f1ff0e2639067d9a730b90">rt_table_init</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00055">55</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">while</span> (!aodvRtTableMap.empty())
    {
        <a class="code" href="NA__routing__table_8cc.html#ad25951a4f27cfba6e1148b6c12d3c0c5">rt_table_delete</a> (aodvRtTableMap.begin()-&gt;second);
        aodvRtTableMap.erase(aodvRtTableMap.begin());
    }
    <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a> = 0;
    <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a> = 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa2ab023febf342ee9ac01a344ebd4e50"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_insert" ref="aa2ab023febf342ee9ac01a344ebd4e50" args="(struct in_addr dest_addr, struct in_addr next, u_int8_t hops, u_int32_t seqno, u_int32_t life, u_int8_t state, u_int16_t flags, unsigned int ifindex, uint32_t cost, uint8_t hopfix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a>* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a48986e841d635c32605c311e04e70692">rt_table_insert</a> </td>
          <td>(</td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>dest_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>hops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>seqno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>life</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ifindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>cost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>hopfix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00074">74</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structrt__table.html">rt_table_t</a> *rt;
    <span class="keyword">struct </span>in_addr nm;
    ManetAddress dest;
    nm.s_addr = ManetAddress::ZERO;

    dest = dest_addr.s_addr;
    <span class="comment">/* Check if we already have an entry for dest_addr */</span>
    AodvRtTableMap::iterator it = aodvRtTableMap.find(dest);
    <span class="keywordflow">if</span> (it != aodvRtTableMap.end())
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;%s already exist in routing table!&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest_addr));
        <span class="keywordflow">return</span> NULL;
    }

    ManetAddress apAdd;
    <span class="keywordflow">if</span> (getAp(dest, apAdd))
    {
        <span class="keyword">struct </span>in_addr dest_addrAux;
        dest_addrAux.s_addr = apAdd;
        <a class="code" href="structrt__table.html">rt_table_t</a> * e = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(dest_addrAux);
        <span class="keywordflow">if</span> (e)
        {
            <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr != next.s_addr &amp;&amp;
                    e-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a> != seqno &amp;&amp;
                    e-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> != flags &amp;&amp;
                    e-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> != hops &amp;&amp;
                    e-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a> != ifindex &amp;&amp;
                    e-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> != state &amp;&amp;
                    e-&gt;<a class="code" href="structrt__table.html#a92c3eda19beb2f0bebd7d0829c817f7b">cost</a> != cost &amp;&amp;
                    e-&gt;<a class="code" href="structrt__table.html#aaa12871457fb77f95c3b6c299950899a">hopfix</a> != hopfix)
                <a class="code" href="NA__routing__table_8cc.html#a30f5595aef61223fe39fa39ebe85126e">rt_table_update</a>(e, next,hops,  seqno,life,  state, flags, ifindex, cost, hopfix);
            <span class="keywordflow">return</span> NULL;
        }
        <span class="keywordflow">else</span>
            rt = <a class="code" href="NA__routing__table_8cc.html#aa2ab023febf342ee9ac01a344ebd4e50">rt_table_insert</a>(dest_addrAux, next,hops,  seqno,life,  state, flags, ifindex, cost, hopfix);
        <span class="keywordflow">return</span> rt;
    }


    <span class="keywordflow">if</span> ((rt = (<a class="code" href="structrt__table.html">rt_table_t</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="structrt__table.html">rt_table_t</a>))) == NULL)
    {
        fprintf(stderr, <span class="stringliteral">&quot;Malloc failed!\n&quot;</span>);
        exit(-1);
    }

    memset(rt, 0, <span class="keyword">sizeof</span>(<a class="code" href="structrt__table.html">rt_table_t</a>));
    rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a> = dest_addr;
    rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a> = next;
    rt-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a> = seqno;
    rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> = flags;
    rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> = hops;
    rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a> = ifindex;
    rt-&gt;<a class="code" href="structrt__table.html#a8af92751cb9668dc43302a4d7e58cbb2">hash</a> = 0;
    rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> = state;
    rt-&gt;<a class="code" href="structrt__table.html#a92c3eda19beb2f0bebd7d0829c817f7b">cost</a> = cost;
    rt-&gt;<a class="code" href="structrt__table.html#aaa12871457fb77f95c3b6c299950899a">hopfix</a> = hopfix;

    <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#a34ff12101d7e56bc8aa8df4df6f5a75a">route_expire_timeout</a>, rt);

    <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#aa91c042a583638a7ab960c2279ad84d3">rrep_ack_timeout</a>, rt);

    <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#af86c8096e8c93a3a961acd9033086bf2">hello_timeout</a>, rt);

    rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_sec = 0;
    rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_usec = 0;
    rt-&gt;<a class="code" href="structrt__table.html#a3b5a178d7185631d88704739b5e7cdfc">hello_cnt</a> = 0;

    rt-&gt;<a class="code" href="structrt__table.html#aa6936b6581e12bb654b598e0230818be">nprec</a> = 0;


    <span class="comment">/* Insert first in bucket... */</span>
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;Inserting %s (bucket %d) next hop %s&quot;</span>,
          <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest_addr), index, <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(next));
    aodvRtTableMap.insert(std::make_pair(dest,rt));
    <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a> = (int) aodvRtTableMap.size();
    <span class="keywordflow">if</span> (state == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
    {

        <span class="keywordflow">if</span> (flags &amp; <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>)
        {
            rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#a8d72cd7c39f6285ef3833c7d6b236176">handler</a> = &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#ae2bea653769ce2d45c36c4a6a05f93c9">local_repair_timeout</a>;
            life = <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>;
        }
        <span class="keywordflow">else</span>
        {
            rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#a8d72cd7c39f6285ef3833c7d6b236176">handler</a> = &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#ab512fd09a083ac6bf97c28d3fec4ef8d">route_delete_timeout</a>;
            life = <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>;
        }

    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>++;
        <span class="comment">/* Add route to omnet inet routing table ... */</span>
        nm.s_addr = ManetAddress(IPv4Address::ALLONES_ADDRESS);
        <span class="keywordflow">if</span> (useIndex)
            omnet_chg_rte(dest_addr, next, nm, hops,<span class="keyword">false</span>,ifindex);
        <span class="keywordflow">else</span>
            omnet_chg_rte(dest_addr, next, nm, hops,<span class="keyword">false</span>,<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(ifindex).ipaddr);
    }

<span class="preprocessor">#ifdef CONFIG_GATEWAY_DISABLE</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a2f5558f39e9b2cc1b42058314ddc9878">RT_GATEWAY</a>)
        <a class="code" href="NA__routing__table_8h.html#a55e686098d9ce5ef3879252f2fe5c4ae">rt_table_update_inet_rt</a>(rt, life);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">//#ifdef NS_PORT</span>
    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;New timer for %s, life=%d&quot;</span>,
          <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>), life);

    <span class="keywordflow">if</span> (life != 0)
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, life);
<span class="comment">//#endif</span>
    <span class="comment">/* In case there are buffered packets for this destination, we</span>
<span class="comment">     * send them on the new route. */</span>
    std::vector&lt;ManetAddress&gt; list;
    getListRelatedAp(dest_addr.s_addr, list);
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; list.size(); i++)
    {
        <span class="keyword">struct </span>in_addr auxAaddr;
        auxAaddr.s_addr = list[i];
        <span class="keywordflow">if</span> ((rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> || rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)  &amp;&amp; <a class="code" href="NA__seek__list_8cc.html#ab7e457fac6a28c55e9d38ed10ad7f2c2">seek_list_remove</a>(<a class="code" href="NA__seek__list_8cc.html#ae26827bd74face659624808c4d7bd517">seek_list_find</a>(auxAaddr)))
        {
            <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>)
                <a class="code" href="NA__packet__queue__omnet_8cc.html#ae754d9d367c7cfb6a0acf34440bb9dfa">packet_queue_set_verdict</a>(auxAaddr, <a class="code" href="NA__packet__queue__omnet_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aacbe4f556779b82ed25d8097fdfc266c">PQ_ENC_SEND</a>);
            <span class="keywordflow">else</span>
                <a class="code" href="NA__packet__queue__omnet_8cc.html#ae754d9d367c7cfb6a0acf34440bb9dfa">packet_queue_set_verdict</a>(auxAaddr, <a class="code" href="NA__packet__queue__omnet_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a3a9b03cb66b2bad1d04fe80c22b94b5a">PQ_SEND</a>);
        }
    }

    <span class="keywordflow">if</span> ( state == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
    {
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
    }
    <span class="keywordflow">return</span> rt;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a155b5e815f7e4be905b3a357f94db03a"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_invalidate" ref="a155b5e815f7e4be905b3a357f94db03a" args="(rt_table_t *rt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#ae2f97bda28b6289f7828076555b47a38">rt_table_invalidate</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l00286">286</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>timeval now;

    gettimeofday(&amp;now, NULL);

    <span class="keywordflow">if</span> (rt == NULL)
        <span class="keywordflow">return</span> -1;

    <span class="comment">/* If the route is already invalidated, do nothing... */</span>
    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Route %s already invalidated!!!&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>));
        <span class="keywordflow">return</span> -1;
    }

    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Route %s is immortal!!!&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>));
        <span class="keywordflow">return</span> -1;
    }

    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>.<a class="code" href="structtimer.html#aae497dabc6a07ecae336dd90c8c3aa0e">used</a>)
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;last HELLO: %ld&quot;</span>,
              timeval_diff(&amp;now, &amp;rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>));
    }

    <span class="comment">/* Remove any pending, but now obsolete timers. */</span>
    <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
    <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
    <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);

    <span class="comment">/* Mark the route as invalid */</span>
    rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> = <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>;
    <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>--;

    rt-&gt;<a class="code" href="structrt__table.html#a3b5a178d7185631d88704739b5e7cdfc">hello_cnt</a> = 0;

    <span class="comment">/* When the lifetime of a route entry expires, increase the sequence</span>
<span class="comment">       number for that entry. */</span>
    <a class="code" href="NA__routing__table_8h.html#adcbbc879166f0c959ee99af816bfa2ce">seqno_incr</a>(rt-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a>);

    rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_sec = 0;
    rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_usec = 0;

    <span class="comment">/* delete route to omnet inet routing table ... */</span>
    <span class="comment">/* if delete is true fiels next, hops and mask are nor used */</span>
    <span class="keyword">struct </span>in_addr nm;
    nm.s_addr = ManetAddress(IPv4Address::ALLONES_ADDRESS);
    omnet_chg_rte(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, nm, 0,<span class="keyword">true</span>);

<span class="preprocessor">#ifdef CONFIG_GATEWAY</span>
<span class="preprocessor"></span>    <span class="comment">/* If this was a gateway, check if any Internet destinations were using</span>
<span class="comment">     * it. In that case update them to use a backup gateway or invalide them</span>
<span class="comment">     * too. */</span>
    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a2f5558f39e9b2cc1b42058314ddc9878">RT_GATEWAY</a>)
    {
        <span class="keywordtype">int</span> i;

        <a class="code" href="structrt__table.html">rt_table_t</a> *gw = <a class="code" href="NA__routing__table_8cc.html#a84be5cffcb9a8b8449732a061f49515b">rt_table_find_gateway</a>();
        <span class="keywordflow">for</span> (AodvRtTableMap::iterator it = aodvRtTableMap.begin(); it != aodvRtTableMap.end(); it++)
        {
            <a class="code" href="structrt__table.html">rt_table_t</a> *rt2 = it-&gt;second;
            <span class="keywordflow">if</span> (rt2-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> &amp;&amp; (rt2-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>) &amp;&amp; (rt2-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr == rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr))
            {
                <span class="keywordflow">if</span> (0)
                {
                    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0,
                            <span class="stringliteral">&quot;Invalidated GW %s but found new GW %s for %s&quot;</span>,
                            <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>),
                            <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(gw-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>),
                            <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt2-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>));
<span class="preprocessor">#ifdef AODV_USE_STL</span>
<span class="preprocessor"></span>                    <span class="keywordtype">double</span> val  = SIMTIME_DBL(rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#af63926c1d0b05f7fe6af1280c7bde571">timeout</a> - simTime())*1000.0;
                    u_int32_t lifetime = 0;
                    <span class="keywordflow">if</span> (val &gt;0)
                        lifetime = val;
                    <a class="code" href="NA__routing__table_8cc.html#a30f5595aef61223fe39fa39ebe85126e">rt_table_update</a>(rt2, gw-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, gw-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>, 0,
                            lifetime, <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>, rt2-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a>,rt2-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>                    <a class="code" href="NA__routing__table_8cc.html#a30f5595aef61223fe39fa39ebe85126e">rt_table_update</a>(rt2, gw-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, gw-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>, 0,
                            timeval_diff(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#af63926c1d0b05f7fe6af1280c7bde571">timeout</a>,&amp;now), <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>, rt2-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a>,rt2-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                }
                <span class="keywordflow">else</span>
                {
                    <a class="code" href="NA__routing__table_8cc.html#a155b5e815f7e4be905b3a357f94db03a">rt_table_invalidate</a>(rt2);
                    <a class="code" href="NA__routing__table_8cc.html#a01a24c260d1ec566bcae0dc82d3867cf">precursor_list_destroy</a>(rt2);
                }
            }
        }
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>)
    {
        <span class="comment">/* Set a timeout for the repair */</span>

        rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#a8d72cd7c39f6285ef3833c7d6b236176">handler</a> = &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#ae2bea653769ce2d45c36c4a6a05f93c9">local_repair_timeout</a>;
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);

        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;%s kept for repairs during %u msecs&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>), <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);
    }
    <span class="keywordflow">else</span>
    {

        <span class="comment">/* Schedule a deletion timer */</span>
        rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#a8d72cd7c39f6285ef3833c7d6b236176">handler</a> = &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#ab512fd09a083ac6bf97c28d3fec4ef8d">route_delete_timeout</a>;
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);

        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;%s removed in %u msecs&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>), <a class="code" href="NA__params_8h.html#a649583ef8b5c7fb8211d207e7776f3f9">DELETE_PERIOD</a>);
    }

    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a30f5595aef61223fe39fa39ebe85126e"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_update" ref="a30f5595aef61223fe39fa39ebe85126e" args="(rt_table_t *rt, struct in_addr next, u_int8_t hops, u_int32_t seqno, u_int32_t lifetime, u_int8_t state, u_int16_t flags, int iface, uint32_t cost, uint8_t hopfix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a>* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a524cd823940c5774d898b7b6afd04899">rt_table_update</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>hops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>seqno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>cost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>hopfix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l01240">1240</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">struct </span>in_addr nm;
    nm.s_addr = ManetAddress::ZERO;

    <span class="keywordflow">if</span> ((rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a> &amp;&amp; state == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>) || (state == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>))
    {

        <span class="comment">/* If this previously was an expired route, but will now be</span>
<span class="comment">           active again we must add it to the kernel routing</span>
<span class="comment">           table... */</span>
        <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
            <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>++;

        <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>)
            flags &amp;= ~<a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>;
        <span class="keywordflow">if</span> (iface &gt;=0 &amp;&amp; rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>!=(uint32_t)iface)
            rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>=iface;

<span class="preprocessor">#ifndef NS_PORT</span>
<span class="preprocessor"></span>        <a class="code" href="NA__nl_8c.html#a8fc2aacd0fd5aead2c4ff62cbabcddbb">nl_send_add_route_msg</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, next, hops, lifetime,
                              flags, rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#ifdef OMNETPP</span>
<span class="preprocessor"></span>        <span class="comment">/* Add route to omnet inet routing table ... */</span>
        nm.s_addr = ManetAddress(IPv4Address::ALLONES_ADDRESS);
        <span class="keywordflow">if</span> (useIndex)
            omnet_chg_rte(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, next, nm, hops,<span class="keyword">false</span>,rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
        <span class="keywordflow">else</span>
            omnet_chg_rte(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, next, nm, hops,<span class="keyword">false</span>,<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>).ipaddr);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr.isUnspecified() &amp;&amp;
             rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>.s_addr != next.s_addr)
    {
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;rt-&gt;next_hop=%s, new_next_hop=%s&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>), <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(next));
        <span class="keywordflow">if</span> (iface &gt;=0 &amp;&amp; rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>!=(uint32_t)iface)
             rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>=iface;
<span class="preprocessor">#ifndef NS_PORT</span>
<span class="preprocessor"></span>        <a class="code" href="NA__nl_8c.html#a8fc2aacd0fd5aead2c4ff62cbabcddbb">nl_send_add_route_msg</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, next, hops, lifetime,
                              flags, rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#ifdef OMNETPP</span>
<span class="preprocessor"></span>        <span class="comment">/* change route to omnet inet routing table ... */</span>
        nm.s_addr = ManetAddress(IPv4Address::ALLONES_ADDRESS);
        <span class="keywordflow">if</span> (useIndex)
            omnet_chg_rte(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, next, nm, hops,<span class="keyword">false</span>,rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>);
        <span class="keywordflow">else</span>
            omnet_chg_rte(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>, next, nm, hops,<span class="keyword">false</span>,<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>).ipaddr);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    }

    <span class="keywordflow">if</span> (hops &gt; 1 &amp;&amp; rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> == 1)
    {
        rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_sec = 0;
        rt-&gt;<a class="code" href="structrt__table.html#a709c6b8c5336ac88a9e14b623b582d30">last_hello_time</a>.tv_usec = 0;
        rt-&gt;<a class="code" href="structrt__table.html#a3b5a178d7185631d88704739b5e7cdfc">hello_cnt</a> = 0;
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
        <span class="comment">/* Must also do a &quot;link break&quot; when updating a 1 hop</span>
<span class="comment">        neighbor in case another routing entry use this as</span>
<span class="comment">        next hop... */</span>
<span class="preprocessor">#ifndef OMNETPP</span>
<span class="preprocessor"></span>        <a class="code" href="NA__aodv__neighbor_8cc.html#ac0b48998364c3e0b91b3b866808187f0">neighbor_link_break</a>(rt);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        <span class="comment">// Added in version aodv-uu 0.9.3, it&#39;s commented for performance reasons</span>
        <span class="comment">//  neighbor_link_break(rt);</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    }
    rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> = flags;
    rt-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a> = seqno;
    rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a> = next;
    rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> = hops;
    rt-&gt;<a class="code" href="structrt__table.html#a92c3eda19beb2f0bebd7d0829c817f7b">cost</a> = cost;
    rt-&gt;<a class="code" href="structrt__table.html#aaa12871457fb77f95c3b6c299950899a">hopfix</a> = hopfix;

<span class="preprocessor">#ifdef CONFIG_GATEWAY</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a2f5558f39e9b2cc1b42058314ddc9878">RT_GATEWAY</a>)
        <a class="code" href="NA__routing__table_8h.html#a55e686098d9ce5ef3879252f2fe5c4ae">rt_table_update_inet_rt</a>(rt, lifetime);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">//#ifdef NS_PORT</span>
    <span class="keywordflow">if</span> (state != <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
    {
        rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#a8d72cd7c39f6285ef3833c7d6b236176">handler</a> = &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__aodv__timeout_8cc.html#a34ff12101d7e56bc8aa8df4df6f5a75a">route_expire_timeout</a>;
        <span class="keywordflow">if</span> (!(rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>))
            <a class="code" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a>(rt, lifetime);
    }
    <span class="keywordflow">else</span>
    {
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
    }
<span class="comment">//#endif</span>

    <span class="comment">/* Finally, mark as VALID */</span>
    rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> = state;

    <span class="comment">/* In case there are buffered packets for this destination, we send</span>
<span class="comment">     * them on the new route. */</span>
    std::vector&lt;ManetAddress&gt; list;
    getListRelatedAp(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr, list);
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; list.size(); i++)
    {
        <span class="keyword">struct </span>in_addr auxAaddr;
        auxAaddr.s_addr = list[i];
        <span class="keywordflow">if</span> ((rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> || rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)&amp;&amp; <a class="code" href="NA__seek__list_8cc.html#ab7e457fac6a28c55e9d38ed10ad7f2c2">seek_list_remove</a>(<a class="code" href="NA__seek__list_8cc.html#ae26827bd74face659624808c4d7bd517">seek_list_find</a>(auxAaddr)))
        {
<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span>
            <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>)
                <a class="code" href="NA__packet__queue__omnet_8cc.html#ae754d9d367c7cfb6a0acf34440bb9dfa">packet_queue_set_verdict</a>(auxAaddr, <a class="code" href="NA__packet__queue__omnet_8h.html#adf764cbdea00d65edcd07bb9953ad2b7aacbe4f556779b82ed25d8097fdfc266c">PQ_ENC_SEND</a>);
            <span class="keywordflow">else</span>
                <a class="code" href="NA__packet__queue__omnet_8cc.html#ae754d9d367c7cfb6a0acf34440bb9dfa">packet_queue_set_verdict</a>(auxAaddr, <a class="code" href="NA__packet__queue__omnet_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a3a9b03cb66b2bad1d04fe80c22b94b5a">PQ_SEND</a>);
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    }
    <span class="keywordflow">return</span> rt;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a438604d7812eff676f0273d700177bc8"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_update_route_timeouts" ref="a438604d7812eff676f0273d700177bc8" args="(rt_table_t *fwd_rt, rt_table_t *rev_rt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a4d097a85558e9418fc2a015454e68890">rt_table_update_route_timeouts</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>fwd_rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rev_rt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l01409">1409</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structrt__table.html">rt_table_t</a> *next_hop_rt = NULL;

    <span class="comment">/* When forwarding a packet, we update the lifetime of the</span>
<span class="comment">       destination&#39;s routing table entry, as well as the entry for the</span>
<span class="comment">       next hop neighbor (if not the same). AODV draft 10, section</span>
<span class="comment">       6.2. */</span>

    <span class="keywordflow">if</span> (fwd_rt &amp;&amp; fwd_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
    {
        <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> || (fwd_rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a> &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>) || fwd_rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> != 1 || fwd_rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>.<a class="code" href="structtimer.html#aae497dabc6a07ecae336dd90c8c3aa0e">used</a>)
            <a class="code" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a>(fwd_rt, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);
        next_hop_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(fwd_rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>);

        <span class="keywordflow">if</span> (next_hop_rt &amp;&amp; next_hop_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> &amp;&amp;
                next_hop_rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr != fwd_rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr &amp;&amp;
                (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> || fwd_rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>.<a class="code" href="structtimer.html#aae497dabc6a07ecae336dd90c8c3aa0e">used</a>))
            <a class="code" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a>(next_hop_rt, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);

    }
    <span class="comment">/* Also update the reverse route and reverse next hop along the</span>
<span class="comment">       path back, since routes between originators and the destination</span>
<span class="comment">       are expected to be symmetric. */</span>
    <span class="keywordflow">if</span> (rev_rt &amp;&amp; rev_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
    {

        <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> || rev_rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> != 1 || rev_rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>.<a class="code" href="structtimer.html#aae497dabc6a07ecae336dd90c8c3aa0e">used</a>)
            <a class="code" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a>(rev_rt, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);

        next_hop_rt = <a class="code" href="NA__routing__table_8cc.html#a69302b8ba8b3ee7f9d6c43eacd4ee43c">rt_table_find</a>(rev_rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>);

        <span class="keywordflow">if</span> (next_hop_rt &amp;&amp; next_hop_rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a> &amp;&amp; rev_rt &amp;&amp;
                next_hop_rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr != rev_rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>.s_addr &amp;&amp;
                (<a class="code" href="main_8c.html#a20ce58c799d3953a9d57e6c3f8910633">llfeedback</a> || rev_rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>.<a class="code" href="structtimer.html#aae497dabc6a07ecae336dd90c8c3aa0e">used</a>))
            <a class="code" href="NA__routing__table_8cc.html#a26317d59b04b99645fb385905635422c">rt_table_update_timeout</a>(next_hop_rt, <a class="code" href="NA__params_8h.html#aba91511b61e5a1a42aba4ae0805c6dfa">ACTIVE_ROUTE_TIMEOUT</a>);

        <span class="comment">/* Update HELLO timer of next hop neighbor if active */</span>
        <span class="comment">/*  if (!llfeedback &amp;&amp; next_hop_rt-&gt;hello_timer.used) { */</span>
        <span class="comment">/*      struct timeval now; */</span>

        <span class="comment">/*      gettimeofday(&amp;now, NULL); */</span>
        <span class="comment">/*      hello_update_timeout(next_hop_rt, &amp;now,  */</span>
        <span class="comment">/*               ALLOWED_HELLO_LOSS * HELLO_INTERVAL); */</span>
        <span class="comment">/*  } */</span>
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a26317d59b04b99645fb385905635422c"></a><!-- doxytag: member="NA_routing_table.cc::rt_table_update_timeout" ref="a26317d59b04b99645fb385905635422c" args="(rt_table_t *rt, u_int32_t lifetime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="NA__defs__aodv_8h.html#a8ee7d4d6f8ffcfc6786cf264af633000">NS_INLINE</a> <a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a>* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__routing__table_8h.html#a79c035a80ef686a957e2d4decf8d62a5">rt_table_update_timeout</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="NA__routing__table_8h.html#acaa7d17e5a6c4e70d3885eecf75ab299">rt_table_t</a> *&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>lifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__routing__table_8cc_source.html#l01368">1368</a> of file <a class="el" href="NA__routing__table_8cc_source.html">NA_routing_table.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (!rt)
        <span class="keywordflow">return</span> NULL;

    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#a6f8693020afbdaeccfa0eaecffe05dd6">IMMORTAL</a>)
    {
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a4b5c6baab186ae8733b48cf2d5172852">ack_timer</a>);
        <a class="code" href="NA__timer__queue__aodv_8cc.html#aea7509bb49b915acbf3377bc3523680c">timer_remove</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a56aadfd52f29b6ca3bece47474dd4ca8">hello_timer</a>);
        <span class="keywordflow">return</span> rt;
    }

    <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a> == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
    {
        <span class="comment">/* Check if the current valid timeout is larger than the new</span>
<span class="comment">           one - in that case keep the old one. */</span>
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Route %s update time out to %d milliseconds&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>),lifetime);

<span class="preprocessor">#ifdef AODV_USE_STL</span>
<span class="preprocessor"></span>        <span class="keywordtype">double</span> interval = ((double)lifetime)/1000.0;
        simtime_t new_timeout = simTime() + interval;
        <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#af63926c1d0b05f7fe6af1280c7bde571">timeout</a> &lt; new_timeout)
            <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, lifetime);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        <span class="keyword">struct </span>timeval new_timeout;
        gettimeofday(&amp;new_timeout, NULL);
        timeval_add_msec(&amp;new_timeout, lifetime);
        <span class="keywordflow">if</span> (timeval_diff(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#af63926c1d0b05f7fe6af1280c7bde571">timeout</a>, &amp;new_timeout) &lt; 0)
            <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, lifetime);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    }
    <span class="keywordflow">else</span>
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>, lifetime);

    <span class="keywordflow">return</span> rt;
}
</pre></div>
</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="NA__routing__table_8cc.html">NA_routing_table.cc</a>      </li>

    <li class="footer">Generated on Fri Oct 18 2013 20:34:56 for NETWORK ATTACKS FRAMEWORK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>

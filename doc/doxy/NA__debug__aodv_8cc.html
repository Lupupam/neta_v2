<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NETWORK ATTACKS FRAMEWORK: NA_debug_aodv.cc File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">NETWORK ATTACKS FRAMEWORK
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A NETwork Attacks framework. Making network attacks impact evaluation easier!</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('NA__debug__aodv_8cc.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">NA_debug_aodv.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="NA__aodv__uu__omnet_8h_source.html">../NA_aodv_uu_omnet.h</a>&quot;</code><br/>
</div>
<p><a href="NA__debug__aodv_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a91e53e3b4f7c1455ebbe969f8a2cc9d6">NS_PORT</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a661b55933ece098127ebc60554ffb304">OMNETPP</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#aecfc084a466c1e43aa3fc757e1ba3818">log_init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#ad648b58f4087c21b60e97762f4d87bf8">log_rt_table_init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#ad7f2a4f9e2cabca7e32a3a29fdcd8a79">log_cleanup</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a58452723d1542126de089a541eaa98bd">write_to_log_file</a> (char *msg, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a93bc3bff0cb558acb0a81ef1103f1976">packet_type</a> (uint32 type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a> (int type, int errnum, const char *function, const char *format,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#ab9005287fdea32df32084d025a891d0c">rreq_flags_to_str</a> (<a class="el" href="structRREQ.html">RREQ</a> *rreq)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a9b56fc84e8c724e031a9e6f8137dc25b">rrep_flags_to_str</a> (<a class="el" href="structRREP.html">RREP</a> *rrep)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a6f298772c189a00cc31d8c4998d6e0ec">log_pkt_fields</a> (<a class="el" href="structAODV__msg.html">AODV_msg</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a77da703803b32d6c76cc7117ba48194d">rt_flags_to_str</a> (u_int16_t flags)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#aa082f15b32ff14d257a5cff9c88a8be3">state_to_str</a> (u_int8_t state)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a3160b8f1d6cb19d9c01a04456e29b0bb">devs_ip_to_str</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#a0547aab17f7f3b8a85ea7c606f4675dd">print_rt_table</a> (void *arg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *<a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a> (struct in_addr addr)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a91e53e3b4f7c1455ebbe969f8a2cc9d6"></a><!-- doxytag: member="NA_debug_aodv.cc::NS_PORT" ref="a91e53e3b4f7c1455ebbe969f8a2cc9d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__timer__queue__aodv_8cc.html#a91e53e3b4f7c1455ebbe969f8a2cc9d6">NS_PORT</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00023">23</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a661b55933ece098127ebc60554ffb304"></a><!-- doxytag: member="NA_debug_aodv.cc::OMNETPP" ref="a661b55933ece098127ebc60554ffb304" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__timer__queue__aodv_8cc.html#a661b55933ece098127ebc60554ffb304">OMNETPP</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00024">24</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="abcaff98caa7648ba8c38888a45cda786"></a><!-- doxytag: member="NA_debug_aodv.cc::alog" ref="abcaff98caa7648ba8c38888a45cda786" args="(int type, int errnum, const char *function, const char *format,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8h.html#a78eb6c20ec8f9c3c56c78eeb3df953f2">alog</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>errnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00160">160</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifndef _WIN32</span>
<span class="preprocessor"></span>    va_list ap;
    <span class="keyword">static</span> <span class="keywordtype">char</span> buffer[256] = <span class="stringliteral">&quot;&quot;</span>;
    <span class="keyword">static</span> <span class="keywordtype">char</span> log_buf[1024];
    <span class="keywordtype">char</span> *msg;
    <span class="keyword">struct </span>timeval now;
    <span class="keyword">struct </span>tm *time;
    <span class="keywordtype">int</span> len = 0;

    <span class="comment">/* NS_PORT: Include IP address in log */</span>
<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(NS_DEV_NR).enabled == 1)
    {
        len += sprintf(log_buf + len, <span class="stringliteral">&quot;%s: &quot;</span>,
                       <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(NS_DEV_NR).ipaddr));
    }
<span class="preprocessor">#endif              </span><span class="comment">/* NS_PORT */</span>

    va_start(ap, format);

    <span class="keywordflow">if</span> (type == LOG_WARNING)
        msg = &amp;buffer[9];
    <span class="keywordflow">else</span>
        msg = buffer;

    vsprintf(msg, format, ap);
    va_end(ap);

    <span class="keywordflow">if</span> (!debug &amp;&amp; !<a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a>)
        <span class="keywordflow">goto</span> syslog;

    gettimeofday(&amp;now, NULL);

<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span>    time = gmtime(&amp;now.tv_sec);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    time = localtime(&amp;now.tv_sec);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="comment">/*   if (type &lt;= LOG_NOTICE) */</span>
    <span class="comment">/*  len += sprintf(log_buf + len, &quot;%s: &quot;, progname); */</span>

    len += sprintf(log_buf + len, <span class="stringliteral">&quot;%s %02d:%02d:%02d.%03ld %s: %s&quot;</span>,nodeName, time-&gt;tm_hour,
                   time-&gt;tm_min, time-&gt;tm_sec, now.tv_usec / 1000, <span class="keyword">function</span>,
                   msg);
<span class="comment">//    len += sprintf(log_buf + len, &quot;%s time = %lf - %s %s &quot;,nodeName, simTime(), function,</span>
<span class="comment">//         msg);</span>

    <span class="keywordflow">if</span> (errnum == 0)
        len += sprintf(log_buf + len, <span class="stringliteral">&quot;\n&quot;</span>);
    <span class="keywordflow">else</span>
        len += sprintf(log_buf + len, <span class="stringliteral">&quot;: %s\n&quot;</span>, strerror(errnum));

    <span class="keywordflow">if</span> (len &gt; 1024)
    {
        fprintf(stderr, <span class="stringliteral">&quot;alog(): buffer to small! len = %d\n&quot;</span>, len);
        <span class="keywordflow">goto</span> syslog;
    }

    <span class="comment">/* OK, we are clear to write the buffer to the aodv log file... */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a>)
        <a class="code" href="NA__debug__aodv_8cc.html#a58452723d1542126de089a541eaa98bd">write_to_log_file</a>(log_buf, len);

    <span class="comment">/* If we have the debug option set, also write to stdout */</span>
    <span class="keywordflow">if</span> (debug)
        fputs(log_buf, stdout);

    <span class="comment">/* Syslog all messages that are of severity LOG_NOTICE or worse */</span>
syslog:
    <span class="keywordflow">if</span> (type &lt;= LOG_NOTICE)
    {
        <span class="keywordflow">if</span> (errnum != 0)
        {
            errno = errnum;
            syslog(type, <span class="stringliteral">&quot;%s: %s: %m&quot;</span>, <span class="keyword">function</span>, msg);
        }
        <span class="keywordflow">else</span>
            syslog(type, <span class="stringliteral">&quot;%s: %s&quot;</span>, <span class="keyword">function</span>, msg);
    }
    <span class="comment">/* Exit on error */</span>
    <span class="keywordflow">if</span> (type &lt;= LOG_ERR)
        exit(-1);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a3160b8f1d6cb19d9c01a04456e29b0bb"></a><!-- doxytag: member="NA_debug_aodv.cc::devs_ip_to_str" ref="a3160b8f1d6cb19d9c01a04456e29b0bb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8cc.html#a3160b8f1d6cb19d9c01a04456e29b0bb">devs_ip_to_str</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00358">358</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">static</span> <span class="keywordtype">char</span> buf[<a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a> * IFNAMSIZ];
    <span class="keywordtype">char</span> *str;
    <span class="keywordtype">int</span> i, index = 0;

    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>; i++)
    {
        <span class="keywordflow">if</span> (!<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).enabled)
            <span class="keywordflow">continue</span>;
        index += sprintf(buf + index, <span class="stringliteral">&quot;%s,&quot;</span>, <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ipaddr));
    }
    str = buf;
    <span class="keywordflow">return</span> str;
}
</pre></div>
</div>
</div>
<a class="anchor" id="acc0381e3baeab5deb9eed755adae18bc"></a><!-- doxytag: member="NA_debug_aodv.cc::ip_to_str" ref="acc0381e3baeab5deb9eed755adae18bc" args="(struct in_addr addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8h.html#a5b4bb1ef62b4df919de00bd5a6748669">ip_to_str</a> </td>
          <td>(</td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00634">634</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">static</span> <span class="keywordtype">char</span> buf[16 * 4];
    <span class="keyword">static</span> <span class="keywordtype">int</span> index = 0;
    <span class="keywordtype">char</span> *str;
<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span><span class="preprocessor">#ifndef OMNETPP</span>
<span class="preprocessor"></span><span class="preprocessor">#undef htonl</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    addr.s_addr = <a class="code" href="NA__aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(addr.s_addr);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#ifdef OMNETPP</span>
<span class="preprocessor"></span>    IPv4Address add_aux(addr.s_addr.getIPv4());
    strcpy(&amp;buf[index],add_aux.str().c_str());
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    strcpy(&amp;buf[index], inet_ntoa(addr));
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    str = &amp;buf[index];
    index += 16;
    index %= 64;
    <span class="keywordflow">return</span> str;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad7f2a4f9e2cabca7e32a3a29fdcd8a79"></a><!-- doxytag: member="NA_debug_aodv.cc::log_cleanup" ref="ad7f2a4f9e2cabca7e32a3a29fdcd8a79" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8h.html#aa4f203e7a359751015c5300bf8eeb5fc">log_cleanup</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00113">113</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifndef _WIN32</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a> &amp;&amp; log_file_fd)
    {
        <span class="keywordflow">if</span> (<a class="code" href="NA__defs__aodv_8h.html#a93ac000c547828f1d36e8107e36b2cd3">NS_OUTSIDE_CLASS</a> close(log_file_fd) &lt; 0)
            fprintf(stderr, <span class="stringliteral">&quot;Could not close log_file_fd!\n&quot;</span>);
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="aecfc084a466c1e43aa3fc757e1ba3818"></a><!-- doxytag: member="NA_debug_aodv.cc::log_init" ref="aecfc084a466c1e43aa3fc757e1ba3818" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8h.html#a958e8ba8f7300649c3f12c77a228f28e">log_init</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00064">64</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifndef _WIN32</span>
<span class="preprocessor"></span>    <span class="comment">/* NS_PORT: Log filename is prefix + IP address + suffix */</span>
<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span>
    <span class="keywordtype">char</span> <a class="code" href="NA__defs__aodv_8h.html#a079d9066624c0b522e8878173a4dd473">AODV_LOG_PATH</a>[strlen(AODV_LOG_PATH_PREFIX) +
                       strlen(AODV_LOG_PATH_SUFFIX) + 16];
    <span class="keywordtype">char</span> <a class="code" href="NA__defs__aodv_8h.html#a1e177a00abe19b7498857bd26091a10d">AODV_RT_LOG_PATH</a>[strlen(AODV_LOG_PATH_PREFIX) +
                          strlen(AODV_RT_LOG_PATH_SUFFIX) + 16];


    sprintf(AODV_LOG_PATH, <span class="stringliteral">&quot;%s%d%s&quot;</span>, AODV_LOG_PATH_PREFIX, node_id,
            AODV_LOG_PATH_SUFFIX);
    sprintf(AODV_RT_LOG_PATH, <span class="stringliteral">&quot;%s%d%s&quot;</span>, AODV_LOG_PATH_PREFIX, node_id,
            AODV_RT_LOG_PATH_SUFFIX);

<span class="preprocessor">#endif              </span><span class="comment">/* NS_PORT */</span>

    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#afa6334ccb70fdb244e4ac3f256241bca">log_to_file</a>)
    {
        <span class="keywordflow">if</span> ((log_file_fd =
                    open(AODV_LOG_PATH, O_RDWR | O_CREAT | O_TRUNC,
                         S_IROTH | S_IWUSR | S_IRUSR | S_IRGRP)) &lt; 0)
        {
            perror(<span class="stringliteral">&quot;open log file failed!&quot;</span>);
            exit(-1);
        }
    }
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a>)
    {
        <span class="keywordflow">if</span> ((log_rt_fd =
                    open(AODV_RT_LOG_PATH, O_RDWR | O_CREAT | O_TRUNC,
                         S_IROTH | S_IWUSR | S_IRUSR | S_IRGRP)) &lt; 0)
        {
            perror(<span class="stringliteral">&quot;open rt log file failed!&quot;</span>);
            exit(-1);
        }
    }
    openlog(<a class="code" href="main_8c.html#ab9e1449fd00c98428516f0b41eddcb10">progname</a>, 0, LOG_DAEMON);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a6f298772c189a00cc31d8c4998d6e0ec"></a><!-- doxytag: member="NA_debug_aodv.cc::log_pkt_fields" ref="a6f298772c189a00cc31d8c4998d6e0ec" args="(AODV_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8h.html#a5ca843eba43ad3611cae3eab3fca4e4e">log_pkt_fields</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAODV__msg.html">AODV_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00287">287</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{

    <a class="code" href="structRREQ.html">RREQ</a> *rreq;
    <a class="code" href="structRREP.html">RREP</a> *rrep;
    <a class="code" href="structRERR.html">RERR</a> *rerr;
    <span class="keyword">struct </span>in_addr dest, orig;

    <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a367cd375e15ce9ae860d778bd08ad2d6">AODV_RREQ</a>:
        rreq = (<a class="code" href="structRREQ.html">RREQ</a> *) msg;
        dest.s_addr = rreq-&gt;<a class="code" href="structRREQ.html#a45d9523cee3586f9529f7a8035a3639e">dest_addr</a>;
        orig.s_addr = rreq-&gt;<a class="code" href="structRREQ.html#ad00af2a4f3ef82f3abb5ca546f061ae0">orig_addr</a>;
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0,
              <span class="stringliteral">&quot;rreq-&gt;flags:%s rreq-&gt;hopcount=%d rreq-&gt;rreq_id=%ld&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#ab9005287fdea32df32084d025a891d0c">rreq_flags_to_str</a>(rreq), rreq-&gt;<a class="code" href="structRREQ.html#a15e476654f78faa03aa4b28a7cce425e">hcnt</a>, <a class="code" href="NA__aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(rreq-&gt;<a class="code" href="structRREQ.html#a4f469136e4af95cd40adbc8f55d4da0e">rreq_id</a>));
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;rreq-&gt;dest_addr:%s rreq-&gt;dest_seqno=%lu&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest), <a class="code" href="NA__aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(rreq-&gt;<a class="code" href="structRREQ.html#a2d62c2f3ca9adda8eb8397cf20e38cf9">dest_seqno</a>));
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;rreq-&gt;orig_addr:%s rreq-&gt;orig_seqno=%ld&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(orig), <a class="code" href="NA__aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(rreq-&gt;<a class="code" href="structRREQ.html#a59153e98953882b638634a517d6ed08b">orig_seqno</a>));
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a>:
        rrep = (<a class="code" href="structRREP.html">RREP</a> *) msg;
        dest.s_addr = rrep-&gt;<a class="code" href="structRREP.html#ac4dc88d082d84d224fd4cd4c3bfaf4e5">dest_addr</a>;
        orig.s_addr = rrep-&gt;<a class="code" href="structRREP.html#ab81827b9ed227cc98dd0dee660034f1a">orig_addr</a>;
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;rrep-&gt;flags:%s rrep-&gt;hcnt=%d&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#a9b56fc84e8c724e031a9e6f8137dc25b">rrep_flags_to_str</a>(rrep), rrep-&gt;<a class="code" href="structRREP.html#a6c5e704acf06604696ea97fbf1971879">hcnt</a>);
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;rrep-&gt;dest_addr:%s rrep-&gt;dest_seqno=%d&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dest), <a class="code" href="NA__aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(rrep-&gt;<a class="code" href="structRREP.html#a3f5f6ad92410717e3387bb3a88b44c59">dest_seqno</a>));
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;rrep-&gt;orig_addr:%s rrep-&gt;lifetime=%d&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(orig), <a class="code" href="NA__aodv__uu__omnet_8h.html#ac317b3e903719ba02894f1710f7f2439">ntohl</a>(rrep-&gt;<a class="code" href="structRREP.html#a9d250f81bc13e28a5c4ba5bf168bddbf">lifetime</a>));
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a81b0117b1fb2a63225257c07e8db2275">AODV_RERR</a>:
        rerr = (<a class="code" href="structRERR.html">RERR</a> *) msg;
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;rerr-&gt;dest_count:%d rerr-&gt;flags=%s&quot;</span>,
              rerr-&gt;<a class="code" href="structRERR.html#aca0421fec134de2a1f74acb36b886dd1">dest_count</a>, rerr-&gt;<a class="code" href="structRERR.html#a942c69b4f2055b740d37b698f853c387">n</a> ? <span class="stringliteral">&quot;N&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>);
        <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad648b58f4087c21b60e97762f4d87bf8"></a><!-- doxytag: member="NA_debug_aodv.cc::log_rt_table_init" ref="ad648b58f4087c21b60e97762f4d87bf8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8h.html#aa7e0c4d01fe6766af96b2f8c81549391">log_rt_table_init</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00107">107</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="NA__timer__queue__aodv_8cc.html#a721feeb3bf29621e58f8914c0d5365c0">timer_init</a>(&amp;rt_log_timer, &amp;<a class="code" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="code" href="NA__debug__aodv_8cc.html#a0547aab17f7f3b8a85ea7c606f4675dd">print_rt_table</a>, NULL);
    <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt_log_timer, <a class="code" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a93bc3bff0cb558acb0a81ef1103f1976"></a><!-- doxytag: member="NA_debug_aodv.cc::packet_type" ref="a93bc3bff0cb558acb0a81ef1103f1976" args="(uint32 type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="NA__debug__aodv_8h.html#a37a63ec44e6ac41cfd0eb6e413bb948b">packet_type</a> </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00142">142</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">static</span> <span class="keywordtype">char</span> temp[50];

    <span class="keywordflow">switch</span> (type)
    {
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a367cd375e15ce9ae860d778bd08ad2d6">AODV_RREQ</a>:
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;AODV_RREQ&quot;</span>;
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a>:
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;AODV_RREP&quot;</span>;
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a81b0117b1fb2a63225257c07e8db2275">AODV_RERR</a>:
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;AODV_RERR&quot;</span>;
    <span class="keywordflow">default</span>:
        sprintf(temp, <span class="stringliteral">&quot;Unknown packet type %d&quot;</span>, type);
        <span class="keywordflow">return</span> temp;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0547aab17f7f3b8a85ea7c606f4675dd"></a><!-- doxytag: member="NA_debug_aodv.cc::print_rt_table" ref="a0547aab17f7f3b8a85ea7c606f4675dd" args="(void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8h.html#a86e2fe8a081520835c8d9d4a0ccb9e03">print_rt_table</a> </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00513">513</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifndef _WIN32</span>
<span class="preprocessor"></span>    <span class="keywordtype">char</span> rt_buf[2048], ifname[64], seqno_str[11];
    <span class="keywordtype">int</span> len = 0;
    <span class="keyword">struct </span>timeval now;
    <span class="keyword">struct </span>tm *time;
    <span class="keywordflow">if</span> (<a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a> == 0)
        <span class="keywordflow">goto</span> schedule;

    gettimeofday(&amp;now, NULL);

<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span>    time = gmtime(&amp;now.tv_sec);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    time = localtime(&amp;now.tv_sec);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    len +=
       sprintf(rt_buf,
                <span class="stringliteral">&quot;# Time: %02d:%02d:%02d.%03ld IP: %s seqno: %u entries/active: %u/%u\n&quot;</span>,
                time-&gt;tm_hour, time-&gt;tm_min, time-&gt;tm_sec, now.tv_usec / 1000,
                <a class="code" href="NA__debug__aodv_8cc.html#a3160b8f1d6cb19d9c01a04456e29b0bb">devs_ip_to_str</a>(), <a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#a42c045dee154a8fd24c7081602aff457">seqno</a>, <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a7125a62fc2021951e4effe615a892fd9">num_entries</a>,
                <a class="code" href="NA__routing__table_8h.html#a56f12e70a7c6b6382f18390882a4efa3">rt_tbl</a>.<a class="code" href="structrouting__table.html#a3c6303b4e2dfb9422d985d3a6200c178">num_active</a>);
    len +=
        sprintf(rt_buf + len,
                <span class="stringliteral">&quot;%-15s %-15s %-3s %-3s %-5s %-6s %-5s %-5s %-15s\n&quot;</span>,
                <span class="stringliteral">&quot;Destination&quot;</span>, <span class="stringliteral">&quot;Next hop&quot;</span>, <span class="stringliteral">&quot;HC&quot;</span>, <span class="stringliteral">&quot;St.&quot;</span>, <span class="stringliteral">&quot;Seqno&quot;</span>, <span class="stringliteral">&quot;Expire&quot;</span>,
                <span class="stringliteral">&quot;Flags&quot;</span>, <span class="stringliteral">&quot;Iface&quot;</span>, <span class="stringliteral">&quot;Precursors&quot;</span>);

    write(log_rt_fd, rt_buf, len);
    len = 0;
    <span class="keywordflow">for</span> (AodvRtTableMap::iterator it = aodvRtTableMap.begin(); it != aodvRtTableMap.end(); it++)
    {
        <a class="code" href="structrt__table.html">rt_table_t</a> *rt = it-&gt;second;

        <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a> == 0)
        sprintf(seqno_str, <span class="stringliteral">&quot;-&quot;</span>);
        <span class="keywordflow">else</span>
        sprintf(seqno_str, <span class="stringliteral">&quot;%u&quot;</span>, rt-&gt;<a class="code" href="structrt__table.html#ad484a2b32ae10b95e9d201ee71c0a658">dest_seqno</a>);

        <span class="comment">/* Print routing table entries one by one... */</span>
<span class="preprocessor">#ifdef AODV_USE_STL</span>
<span class="preprocessor"></span>        <span class="keywordtype">long</span> dif = (1000.0*(SIMTIME_DBL(rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#af63926c1d0b05f7fe6af1280c7bde571">timeout</a>) - SIMTIME_DBL(simTime())));

        <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.empty())
            len += sprintf(rt_buf + len,
                <span class="stringliteral">&quot;%-15s %-15s %-3d %-3s %-5s %-6lu %-5s %-5s\n&quot;</span>,
                <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>),
                <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>), rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>,
                <a class="code" href="NA__debug__aodv_8cc.html#aa082f15b32ff14d257a5cff9c88a8be3">state_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a>), seqno_str,
                (rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> == 255) ? 0 :
                dif,
                <a class="code" href="NA__debug__aodv_8cc.html#a77da703803b32d6c76cc7117ba48194d">rt_flags_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a>),
                <a class="code" href="NA__aodv__uu__omnet_8cc.html#a2e4aac37cd617a4ec5bccaeb11747534">if_indextoname</a>(rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>, ifname));

        <span class="keywordflow">else</span>
        {

            len += sprintf(rt_buf + len,
                    <span class="stringliteral">&quot;%-15s %-15s %-3d %-3s %-5s %-6lu %-5s %-5s %-15s\n&quot;</span>,
                    <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>),
                    <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>), rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>,
                    <a class="code" href="NA__debug__aodv_8cc.html#aa082f15b32ff14d257a5cff9c88a8be3">state_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a>), seqno_str,
                    (rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> == 255) ? 0 :
                    dif,
                    <a class="code" href="NA__debug__aodv_8cc.html#a77da703803b32d6c76cc7117ba48194d">rt_flags_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a>),
                    <a class="code" href="NA__aodv__uu__omnet_8cc.html#a2e4aac37cd617a4ec5bccaeb11747534">if_indextoname</a>(rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>, ifname),
                    <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>[0].neighbor));
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>         <span class="keywordflow">if</span> (rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.empty())
             len += sprintf(rt_buf + len,
                     <span class="stringliteral">&quot;%-15s %-15s %-3d %-3s %-5s %-6lu %-5s %-5s\n&quot;</span>,
                     <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>),
                     <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>), rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>,
                     <a class="code" href="NA__debug__aodv_8cc.html#aa082f15b32ff14d257a5cff9c88a8be3">state_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a>), seqno_str,
                     (rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> == 255) ? 0 :
                             timeval_diff(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#af63926c1d0b05f7fe6af1280c7bde571">timeout</a>, &amp;now),
                             <a class="code" href="NA__debug__aodv_8cc.html#a77da703803b32d6c76cc7117ba48194d">rt_flags_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a>),
                             <a class="code" href="NA__aodv__uu__omnet_8cc.html#a2e4aac37cd617a4ec5bccaeb11747534">if_indextoname</a>(rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>, ifname));
         <span class="keywordflow">else</span>
         {
            len += sprintf(rt_buf + len,
                    <span class="stringliteral">&quot;%-15s %-15s %-3d %-3s %-5s %-6lu %-5s %-5s %-15s\n&quot;</span>,
                    <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#ac480e49c5adabc5b6bbb5f18386c8de5">dest_addr</a>),
                    <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a1046410b40a5ebff3e93efd435370cb3">next_hop</a>), rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a>,
                    <a class="code" href="NA__debug__aodv_8cc.html#aa082f15b32ff14d257a5cff9c88a8be3">state_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a5244f2f5c228579ca6f0797a1f45eb68">state</a>), seqno_str,
                    (rt-&gt;<a class="code" href="structrt__table.html#aba34d8b3ef7e7556aa19d832770abe7f">hcnt</a> == 255) ? 0 :
                            timeval_diff(&amp;rt-&gt;<a class="code" href="structrt__table.html#a3c6af9d87e4429f83b6ffff58f860252">rt_timer</a>.<a class="code" href="structtimer.html#af63926c1d0b05f7fe6af1280c7bde571">timeout</a>, &amp;now),
                            <a class="code" href="NA__debug__aodv_8cc.html#a77da703803b32d6c76cc7117ba48194d">rt_flags_to_str</a>(rt-&gt;<a class="code" href="structrt__table.html#a8eb483787e5405f1243e2a29458bd30d">flags</a>),
                            <a class="code" href="NA__aodv__uu__omnet_8cc.html#a2e4aac37cd617a4ec5bccaeb11747534">if_indextoname</a>(rt-&gt;<a class="code" href="structrt__table.html#a665abe74b795976e9dffc9d1c3a586b2">ifindex</a>, ifname),
                            <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(((<a class="code" href="structprecursor.html">precursor_t</a> *) rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>[0].neighbor));
#endif
            <span class="comment">/* Print all precursors for the current routing entry */</span>
            for (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i&lt; rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>.size(); i++)
            {
                <a class="code" href="structprecursor.html">precursor_t</a> *pr = &amp;rt-&gt;<a class="code" href="structrt__table.html#ad1ee57d7c26c015d20cd3de46878dc9b">precursors</a>[i];
                len += sprintf(rt_buf + len, <span class="stringliteral">&quot;%64s %-15s\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>,<a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(pr-&gt;<a class="code" href="structprecursor.html#afc67329c006c8ba2e0f1ae4718d16cda">neighbor</a>));

                    <span class="comment">/* Since the precursor list is grown dynamically</span>
<span class="comment">                     * the write buffer should be flushed for every</span>
<span class="comment">                     * entry to avoid buffer overflows */</span>
                 write(log_rt_fd, rt_buf, len);
                 len = 0;

             }
         }
         <span class="keywordflow">if</span> (len &gt; 0)
         {
             write(log_rt_fd, rt_buf, len);
             len = 0;
         }
    }
        <span class="comment">/* Schedule a new printing of routing table... */</span>
    schedule:
        <a class="code" href="NA__timer__queue__aodv_8cc.html#ace41c2dc22720e5daac03344ac0a4102">timer_set_timeout</a>(&amp;rt_log_timer, <a class="code" href="main_8c.html#a10b915edc92aec7ca4584b10aacdb7e7">rt_log_interval</a>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a9b56fc84e8c724e031a9e6f8137dc25b"></a><!-- doxytag: member="NA_debug_aodv.cc::rrep_flags_to_str" ref="a9b56fc84e8c724e031a9e6f8137dc25b" args="(RREP *rrep)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8cc.html#a9b56fc84e8c724e031a9e6f8137dc25b">rrep_flags_to_str</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRREP.html">RREP</a> *&#160;</td>
          <td class="paramname"><em>rrep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00270">270</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">static</span> <span class="keywordtype">char</span> buf[3];
    <span class="keywordtype">int</span> len = 0;
    <span class="keywordtype">char</span> *str;

    <span class="keywordflow">if</span> (rrep-&gt;<a class="code" href="structRREP.html#a97aba968b548c733efa64e63511de573">r</a>)
        buf[len++] = <span class="charliteral">&#39;R&#39;</span>;
    <span class="keywordflow">if</span> (rrep-&gt;<a class="code" href="structRREP.html#abe45cd7d5c14dc356ecab531b2176242">a</a>)
        buf[len++] = <span class="charliteral">&#39;A&#39;</span>;

    buf[len] = <span class="charliteral">&#39;\0&#39;</span>;

    str = buf;
    <span class="keywordflow">return</span> str;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab9005287fdea32df32084d025a891d0c"></a><!-- doxytag: member="NA_debug_aodv.cc::rreq_flags_to_str" ref="ab9005287fdea32df32084d025a891d0c" args="(RREQ *rreq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8cc.html#ab9005287fdea32df32084d025a891d0c">rreq_flags_to_str</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRREQ.html">RREQ</a> *&#160;</td>
          <td class="paramname"><em>rreq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00249">249</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">static</span> <span class="keywordtype">char</span> buf[5];
    <span class="keywordtype">int</span> len = 0;
    <span class="keywordtype">char</span> *str;

    <span class="keywordflow">if</span> (rreq-&gt;<a class="code" href="structRREQ.html#ab93400f5a066176fbd03a4a3c1f96827">j</a>)
        buf[len++] = <span class="charliteral">&#39;J&#39;</span>;
    <span class="keywordflow">if</span> (rreq-&gt;<a class="code" href="structRREQ.html#ab86a51ad9143ee065774620e732bf14d">r</a>)
        buf[len++] = <span class="charliteral">&#39;R&#39;</span>;
    <span class="keywordflow">if</span> (rreq-&gt;<a class="code" href="structRREQ.html#abfe4a1fbdd22fb97ad70543f35d12d57">g</a>)
        buf[len++] = <span class="charliteral">&#39;G&#39;</span>;
    <span class="keywordflow">if</span> (rreq-&gt;<a class="code" href="structRREQ.html#a597864126a8d5faeb1e9c500675a2b99">d</a>)
        buf[len++] = <span class="charliteral">&#39;D&#39;</span>;

    buf[len] = <span class="charliteral">&#39;\0&#39;</span>;

    str = buf;
    <span class="keywordflow">return</span> str;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77da703803b32d6c76cc7117ba48194d"></a><!-- doxytag: member="NA_debug_aodv.cc::rt_flags_to_str" ref="a77da703803b32d6c76cc7117ba48194d" args="(u_int16_t flags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8cc.html#a77da703803b32d6c76cc7117ba48194d">rt_flags_to_str</a> </td>
          <td>(</td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>flags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00328">328</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keyword">static</span> <span class="keywordtype">char</span> buf[5];
    <span class="keywordtype">int</span> len = 0;
    <span class="keywordtype">char</span> *str;

    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="NA__routing__table_8h.html#adcb78e3d580f80f48cb665c2cbc5c99b">RT_UNIDIR</a>)
        buf[len++] = <span class="charliteral">&#39;U&#39;</span>;
    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="NA__routing__table_8h.html#a9be54cbcb590c1da1bae887e4fa48152">RT_REPAIR</a>)
        buf[len++] = <span class="charliteral">&#39;R&#39;</span>;
    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="NA__routing__table_8h.html#a4f25f14df0966a49e4c012e651688179">RT_INET_DEST</a>)
        buf[len++] = <span class="charliteral">&#39;I&#39;</span>;
    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="NA__routing__table_8h.html#a2f5558f39e9b2cc1b42058314ddc9878">RT_GATEWAY</a>)
        buf[len++] = <span class="charliteral">&#39;G&#39;</span>;
    buf[len] = <span class="charliteral">&#39;\0&#39;</span>;

    str = buf;
    <span class="keywordflow">return</span> str;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa082f15b32ff14d257a5cff9c88a8be3"></a><!-- doxytag: member="NA_debug_aodv.cc::state_to_str" ref="aa082f15b32ff14d257a5cff9c88a8be3" args="(u_int8_t state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8cc.html#aa082f15b32ff14d257a5cff9c88a8be3">state_to_str</a> </td>
          <td>(</td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00348">348</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (state == <a class="code" href="NA__routing__table_8h.html#ad47ac60ff0cfac53148a07bc32fc7585">VALID</a>)
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;VAL&quot;</span>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state == <a class="code" href="NA__routing__table_8h.html#adf770fe2eec438e3758ffe905dbae208">INVALID</a>)
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;INV&quot;</span>;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> <span class="stringliteral">&quot;?&quot;</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a58452723d1542126de089a541eaa98bd"></a><!-- doxytag: member="NA_debug_aodv.cc::write_to_log_file" ref="a58452723d1542126de089a541eaa98bd" args="(char *msg, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__defs__aodv_8h.html#a05cf0a58bc81df9625ff2581b0f8b5f3">NS_CLASS</a> <a class="el" href="NA__debug__aodv_8cc.html#a58452723d1542126de089a541eaa98bd">write_to_log_file</a> </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__debug__aodv_8cc_source.html#l00124">124</a> of file <a class="el" href="NA__debug__aodv_8cc_source.html">NA_debug_aodv.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifndef _WIN32</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (!log_file_fd)
    {
        fprintf(stderr, <span class="stringliteral">&quot;Could not write to log file\n&quot;</span>);
        <span class="keywordflow">return</span>;
    }
    <span class="keywordflow">if</span> (len &lt;= 0)
    {
        fprintf(stderr, <span class="stringliteral">&quot;len=0\n&quot;</span>);
        <span class="keywordflow">return</span>;
    }
    <span class="keywordflow">if</span> (write(log_file_fd, msg, len) &lt; 0)
        perror(<span class="stringliteral">&quot;Could not write to log file&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="NA__debug__aodv_8cc.html">NA_debug_aodv.cc</a>      </li>

    <li class="footer">Generated on Fri Oct 18 2013 20:34:56 for NETWORK ATTACKS FRAMEWORK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>

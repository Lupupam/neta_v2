<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>NETWORK ATTACKS FRAMEWORK: NA_aodv_socket.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">NETWORK ATTACKS FRAMEWORK
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A NETwork Attacks framework. Making network attacks impact evaluation easier!</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('NA__aodv__socket_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">NA_aodv_socket.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="NA__defs__aodv_8h_source.html">NA_defs_aodv.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="NA__aodv__rerr_8h_source.html">NA_aodv_rerr.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="NA__params_8h_source.html">NA_params.h</a>&quot;</code><br/>
<code>#include &lt;netinet/ip.h&gt;</code><br/>
</div>
<p><a href="NA__aodv__socket_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a96775901e8ca4b4e16fd4e42a803feff">IPHDR_SIZE</a>&#160;&#160;&#160;sizeof(struct iphdr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a553c3a8e16d55efc119b3605780730c1">AODV_MSG_MAX_SIZE</a>&#160;&#160;&#160;<a class="el" href="NA__aodv__msg__struct_8h.html#a43385e36b22d7a3af5fe3211ae94363a">RERR_SIZE</a> + 100 * <a class="el" href="NA__aodv__msg__struct_8h.html#a71a361b9a59eb0aaba549cc8da272f7d">RERR_UDEST_SIZE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#ae54f3392c5fb7dec3240a5383e531684">RECV_BUF_SIZE</a>&#160;&#160;&#160;<a class="el" href="NA__aodv__socket_8h.html#a553c3a8e16d55efc119b3605780730c1">AODV_MSG_MAX_SIZE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a4c6ddff94506616bb52409dfd2af1d0c">SEND_BUF_SIZE</a>&#160;&#160;&#160;<a class="el" href="NA__aodv__socket_8h.html#ae54f3392c5fb7dec3240a5383e531684">RECV_BUF_SIZE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a37d0e2bc166b19239f5fa586e35265aa">CMSG_NXTHDR_FIX</a>(mhdr, cmsg)&#160;&#160;&#160;<a class="el" href="NA__aodv__socket_8h.html#ab131f150a3dd51dbb5d6096fcc9802cb">cmsg_nxthdr_fix</a>((mhdr), (cmsg))</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a54db369051b8492768e1e931a400f0cc">aodv_socket_init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a16fb4b683d69829242c45cad4530a00a">aodv_socket_send</a> (<a class="el" href="structAODV__msg.html">AODV_msg</a> *aodv_msg, struct in_addr dst, int len, u_int8_t ttl, struct <a class="el" href="structdev__info.html">dev_info</a> *dev, double delay=-1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structAODV__msg.html">AODV_msg</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a14f13b555897ccb9d3619b2e5d1c8af8">aodv_socket_new_msg</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structAODV__msg.html">AODV_msg</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a0addab2c6796c6d480d71b776f2b491b">aodv_socket_queue_msg</a> (<a class="el" href="structAODV__msg.html">AODV_msg</a> *aodv_msg, int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a9872b1563016dfb12cc23865595459ad">aodv_socket_cleanup</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#ab1e61ad5e91d26be71cad4db7fdb6f8a">aodv_socket_process_packet</a> (<a class="el" href="structAODV__msg.html">AODV_msg</a> *aodv_msg, int len, struct in_addr src, struct in_addr dst, int ttl, unsigned int ifindex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct cmsghdr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#ab131f150a3dd51dbb5d6096fcc9802cb">cmsg_nxthdr_fix</a> (struct msghdr *__msg, struct cmsghdr *__cmsg)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct timeval&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a> [<a class="el" href="NA__params_8h.html#adc80c7e4d1a44c3a798e7eccf3926466">RREQ_RATELIMIT</a>-1]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct timeval&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a> [<a class="el" href="NA__params_8h.html#a8836c9bf0c32fec641a332c5a10e0c8c">RERR_RATELIMIT</a>-1]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a425356b81e173631ab1116ca2f0464ef">num_rreq</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NA__aodv__socket_8h.html#a2c5a4291e7e7b1c49583d65ce1c0a679">num_rerr</a></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a553c3a8e16d55efc119b3605780730c1"></a><!-- doxytag: member="NA_aodv_socket.h::AODV_MSG_MAX_SIZE" ref="a553c3a8e16d55efc119b3605780730c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__aodv__socket_8h.html#a553c3a8e16d55efc119b3605780730c1">AODV_MSG_MAX_SIZE</a>&#160;&#160;&#160;<a class="el" href="NA__aodv__msg__struct_8h.html#a43385e36b22d7a3af5fe3211ae94363a">RERR_SIZE</a> + 100 * <a class="el" href="NA__aodv__msg__struct_8h.html#a71a361b9a59eb0aaba549cc8da272f7d">RERR_UDEST_SIZE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00043">43</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<a class="anchor" id="a37d0e2bc166b19239f5fa586e35265aa"></a><!-- doxytag: member="NA_aodv_socket.h::CMSG_NXTHDR_FIX" ref="a37d0e2bc166b19239f5fa586e35265aa" args="(mhdr, cmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__aodv__socket_8h.html#a37d0e2bc166b19239f5fa586e35265aa">CMSG_NXTHDR_FIX</a></td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mhdr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">cmsg&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="NA__aodv__socket_8h.html#ab131f150a3dd51dbb5d6096fcc9802cb">cmsg_nxthdr_fix</a>((mhdr), (cmsg))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00065">65</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<a class="anchor" id="a96775901e8ca4b4e16fd4e42a803feff"></a><!-- doxytag: member="NA_aodv_socket.h::IPHDR_SIZE" ref="a96775901e8ca4b4e16fd4e42a803feff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__aodv__socket_8h.html#a96775901e8ca4b4e16fd4e42a803feff">IPHDR_SIZE</a>&#160;&#160;&#160;sizeof(struct iphdr)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00037">37</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae54f3392c5fb7dec3240a5383e531684"></a><!-- doxytag: member="NA_aodv_socket.h::RECV_BUF_SIZE" ref="ae54f3392c5fb7dec3240a5383e531684" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__aodv__socket_8h.html#ae54f3392c5fb7dec3240a5383e531684">RECV_BUF_SIZE</a>&#160;&#160;&#160;<a class="el" href="NA__aodv__socket_8h.html#a553c3a8e16d55efc119b3605780730c1">AODV_MSG_MAX_SIZE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00044">44</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4c6ddff94506616bb52409dfd2af1d0c"></a><!-- doxytag: member="NA_aodv_socket.h::SEND_BUF_SIZE" ref="a4c6ddff94506616bb52409dfd2af1d0c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="NA__aodv__socket_8h.html#a4c6ddff94506616bb52409dfd2af1d0c">SEND_BUF_SIZE</a>&#160;&#160;&#160;<a class="el" href="NA__aodv__socket_8h.html#ae54f3392c5fb7dec3240a5383e531684">RECV_BUF_SIZE</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00045">45</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9872b1563016dfb12cc23865595459ad"></a><!-- doxytag: member="NA_aodv_socket.h::aodv_socket_cleanup" ref="a9872b1563016dfb12cc23865595459ad" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__aodv__socket_8h.html#a9872b1563016dfb12cc23865595459ad">aodv_socket_cleanup</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8cc_source.html#l00741">741</a> of file <a class="el" href="NA__aodv__socket_8cc_source.html">NA_aodv_socket.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifndef NS_PORT</span>
<span class="preprocessor"></span>    <span class="keywordtype">int</span> i;

    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>; i++)
    {
        <span class="keywordflow">if</span> (!<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).enabled)
            <span class="keywordflow">continue</span>;
        close(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock);
    }
<span class="preprocessor">#endif              </span><span class="comment">/* NS_PORT */</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a54db369051b8492768e1e931a400f0cc"></a><!-- doxytag: member="NA_aodv_socket.h::aodv_socket_init" ref="a54db369051b8492768e1e931a400f0cc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__aodv__socket_8h.html#a54db369051b8492768e1e931a400f0cc">aodv_socket_init</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8cc_source.html#l00087">87</a> of file <a class="el" href="NA__aodv__socket_8cc_source.html">NA_aodv_socket.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="preprocessor">#ifndef NS_PORT</span>
<span class="preprocessor"></span>    <span class="keyword">struct </span>sockaddr_in aodv_addr;
    <span class="keyword">struct </span>ifreq ifr;
    <span class="keywordtype">int</span> i, retval = 0;
    <span class="keywordtype">int</span> on = 1;
    <span class="keywordtype">int</span> tos = IPTOS_LOWDELAY;
    <span class="keywordtype">int</span> bufsize = SO_RECVBUF_SIZE;
    socklen_t optlen = <span class="keyword">sizeof</span>(bufsize);

    <span class="comment">/* Create a UDP socket */</span>

    <span class="keywordflow">if</span> (<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#aac008fcec2a6f263cdb7a328a1677a62">nif</a> == 0)
    {
        fprintf(stderr, <span class="stringliteral">&quot;No interfaces configured\n&quot;</span>);
        exit(-1);
    }

    <span class="comment">/* Open a socket for every AODV enabled interface */</span>
    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="NA__defs__aodv_8h.html#a995d79de9a32d682e10323e736e94505">MAX_NR_INTERFACES</a>; i++)
    {
        <span class="keywordflow">if</span> (!<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).enabled)
            <span class="keywordflow">continue</span>;

        <span class="comment">/* AODV socket */</span>
        <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock = socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP);
        <span class="keywordflow">if</span> (<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock &lt; 0)
        {
            perror(<span class="stringliteral">&quot;&quot;</span>);
            exit(-1);
        }
<span class="preprocessor">#ifdef CONFIG_GATEWAY</span>
<span class="preprocessor"></span>        <span class="comment">/* Data packet send socket */</span>
        <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).psock = socket(PF_INET, SOCK_RAW, IPPROTO_RAW);

        <span class="keywordflow">if</span> (<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).psock &lt; 0)
        {
            perror(<span class="stringliteral">&quot;&quot;</span>);
            exit(-1);
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="comment">/* Bind the socket to the AODV port number */</span>
        memset(&amp;aodv_addr, 0, <span class="keyword">sizeof</span>(aodv_addr));
        aodv_addr.sin_family = AF_INET;
        aodv_addr.sin_port = <a class="code" href="NA__aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="NA__defs__aodv_8h.html#a8e8ce4ef9316894dd0cce190afef212d">AODV_PORT</a>);
        aodv_addr.sin_addr.s_addr = <a class="code" href="NA__aodv__uu__omnet_8h.html#ae4027a6ad07f13aa12eab285a1b46019">htonl</a>(INADDR_ANY);

        retval = bind(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, (<span class="keyword">struct</span> sockaddr *) &amp;aodv_addr,
                      <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr));

        <span class="keywordflow">if</span> (retval &lt; 0)
        {
            perror(<span class="stringliteral">&quot;Bind failed &quot;</span>);
            exit(-1);
        }
        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, SOL_SOCKET, SO_BROADCAST,
                       &amp;on, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)) &lt; 0)
        {
            perror(<span class="stringliteral">&quot;SO_BROADCAST failed &quot;</span>);
            exit(-1);
        }

        memset(&amp;ifr, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> ifreq));
        strcpy(ifr.ifr_name, <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ifname);

        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, SOL_SOCKET, SO_BINDTODEVICE,
                       &amp;ifr, <span class="keyword">sizeof</span>(ifr)) &lt; 0)
        {
            fprintf(stderr, <span class="stringliteral">&quot;SO_BINDTODEVICE failed for %s&quot;</span>, <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ifname);
            perror(<span class="stringliteral">&quot; &quot;</span>);
            exit(-1);
        }

        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, SOL_SOCKET, SO_PRIORITY,
                       &amp;tos, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)) &lt; 0)
        {
            perror(<span class="stringliteral">&quot;Setsockopt SO_PRIORITY failed &quot;</span>);
            exit(-1);
        }

        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, SOL_IP, IP_RECVTTL,
                       &amp;on, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)) &lt; 0)
        {
            perror(<span class="stringliteral">&quot;Setsockopt IP_RECVTTL failed &quot;</span>);
            exit(-1);
        }

        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, SOL_IP, IP_PKTINFO,
                       &amp;on, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)) &lt; 0)
        {
            perror(<span class="stringliteral">&quot;Setsockopt IP_PKTINFO failed &quot;</span>);
            exit(-1);
        }
<span class="preprocessor">#ifdef CONFIG_GATEWAY</span>
<span class="preprocessor"></span>        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).psock, SOL_SOCKET, SO_BINDTODEVICE,
                       &amp;ifr, <span class="keyword">sizeof</span>(ifr)) &lt; 0)
        {
            fprintf(stderr, <span class="stringliteral">&quot;SO_BINDTODEVICE failed for %s&quot;</span>, <a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).ifname);
            perror(<span class="stringliteral">&quot; &quot;</span>);
            exit(-1);
        }

        bufsize = 4 * 65535;

        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).psock, SOL_SOCKET, SO_SNDBUF,
                       (<span class="keywordtype">char</span> *) &amp;bufsize, optlen) &lt; 0)
        {
            <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_NOTICE, 0, <span class="stringliteral">&quot;Could not set send socket buffer size&quot;</span>);
        }
        <span class="keywordflow">if</span> (getsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).psock, SOL_SOCKET, SO_SNDBUF,
                       (<span class="keywordtype">char</span> *) &amp;bufsize, &amp;optlen) == 0)
        {
            <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_NOTICE, 0, __FUNCTION__,
                 <span class="stringliteral">&quot;RAW send socket buffer size set to %d&quot;</span>, bufsize);
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="comment">/* Set max allowable receive buffer size... */</span>
        <span class="keywordflow">for</span> (;; bufsize -= 1024)
        {
            <span class="keywordflow">if</span> (setsockopt(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, SOL_SOCKET, SO_RCVBUF,
                           (<span class="keywordtype">char</span> *) &amp;bufsize, optlen) == 0)
            {
                <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_NOTICE, 0, __FUNCTION__,
                     <span class="stringliteral">&quot;Receive buffer size set to %d&quot;</span>, bufsize);
                <span class="keywordflow">break</span>;
            }
            <span class="keywordflow">if</span> (bufsize &lt; <a class="code" href="NA__aodv__socket_8h.html#ae54f3392c5fb7dec3240a5383e531684">RECV_BUF_SIZE</a>)
            {
                <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_ERR, 0, __FUNCTION__,
                     <span class="stringliteral">&quot;Could not set receive buffer size&quot;</span>);
                exit(-1);
            }
        }

        retval = <a class="code" href="main_8c.html#a2a74ba48855a88762b22fd3bc4e59db6">attach_callback_func</a>(<a class="code" href="NA__defs__aodv_8h.html#ab95b1afa61dd1a2cf987d8a56ad6be03">DEV_NR</a>(i).sock, aodv_socket_read);

        <span class="keywordflow">if</span> (retval &lt; 0)
        {
            perror(<span class="stringliteral">&quot;register input handler failed &quot;</span>);
            exit(-1);
        }
    }
<span class="preprocessor">#endif              </span><span class="comment">/* NS_PORT */</span>

    <a class="code" href="NA__aodv__socket_8h.html#a425356b81e173631ab1116ca2f0464ef">num_rreq</a> = 0;
    <a class="code" href="NA__aodv__socket_8h.html#a2c5a4291e7e7b1c49583d65ce1c0a679">num_rerr</a> = 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a14f13b555897ccb9d3619b2e5d1c8af8"></a><!-- doxytag: member="NA_aodv_socket.h::aodv_socket_new_msg" ref="a14f13b555897ccb9d3619b2e5d1c8af8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structAODV__msg.html">AODV_msg</a>* <a class="el" href="NA__aodv__socket_8h.html#a14f13b555897ccb9d3619b2e5d1c8af8">aodv_socket_new_msg</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab1e61ad5e91d26be71cad4db7fdb6f8a"></a><!-- doxytag: member="NA_aodv_socket.h::aodv_socket_process_packet" ref="ab1e61ad5e91d26be71cad4db7fdb6f8a" args="(AODV_msg *aodv_msg, int len, struct in_addr src, struct in_addr dst, int ttl, unsigned int ifindex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__aodv__socket_8h.html#ab1e61ad5e91d26be71cad4db7fdb6f8a">aodv_socket_process_packet</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAODV__msg.html">AODV_msg</a> *&#160;</td>
          <td class="paramname"><em>aodv_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ttl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>ifindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8cc_source.html#l00236">236</a> of file <a class="el" href="NA__aodv__socket_8cc_source.html">NA_aodv_socket.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">/* If this was a HELLO message... Process as HELLO. */</span>
<span class="preprocessor">#ifndef OMNETPP</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ((aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a> == <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a> &amp;&amp; ttl == 1 &amp;&amp;
            dst.s_addr == <a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>))
    {
        <a class="code" href="NA__aodv__hello_8cc.html#a7cfca0e4f03ae6e3a653659cabc50ce9">hello_process</a>((<a class="code" href="structRREP.html">RREP</a> *) aodv_msg, len, ifindex);
        <span class="keywordflow">return</span>;
    }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> ((aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a> == <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a> &amp;&amp; ttl == 0 &amp;&amp; <span class="comment">// ttl is decremented for ip layer before send to aodv</span>
            dst.s_addr == ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>))))
    {
        <a class="code" href="NA__aodv__hello_8cc.html#a7cfca0e4f03ae6e3a653659cabc50ce9">hello_process</a>((<a class="code" href="structRREP.html">RREP</a> *) aodv_msg, len, ifindex);
        <span class="keywordflow">return</span>;
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <span class="comment">/* Make sure we add/update neighbors */</span>
    <a class="code" href="NA__aodv__neighbor_8cc.html#a8e8598ad99bb391d3541f57c6b75bc9c">neighbor_add</a>(aodv_msg, src, ifindex);

    <span class="comment">/* Check what type of msg we received and call the corresponding</span>
<span class="comment">       function to handle the msg... */</span>
    <span class="keywordflow">switch</span> (aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a>)
    {

    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a367cd375e15ce9ae860d778bd08ad2d6">AODV_RREQ</a>:
        <a class="code" href="NA__aodv__rreq_8cc.html#affac4a5837bdf5c895943d9f68920b02">rreq_process</a>((<a class="code" href="structRREQ.html">RREQ</a> *) aodv_msg, len, src, dst, ttl, ifindex);
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a>:
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Received RREP&quot;</span>);
        <a class="code" href="NA__aodv__rrep_8cc.html#a90bd053226410ba9ca2c121ae06648e0">rrep_process</a>((<a class="code" href="structRREP.html">RREP</a> *) aodv_msg, len, src, dst, ttl, ifindex);
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a81b0117b1fb2a63225257c07e8db2275">AODV_RERR</a>:
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Received RERR&quot;</span>);
        <a class="code" href="NA__aodv__rerr_8cc.html#a19140aae9f0ec31c3557739bc721b9e4">rerr_process</a>((<a class="code" href="structRERR.html">RERR</a> *) aodv_msg, len, src, dst);
        <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a488deb98e00627c2ada09faeba3b792c">AODV_RREP_ACK</a>:
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;Received RREP_ACK&quot;</span>);
        <a class="code" href="NA__aodv__rrep_8cc.html#a289f4892be8cccdc429d8d33f1f17aa6">rrep_ack_process</a>((<a class="code" href="structRREP__ack.html">RREP_ack</a> *) aodv_msg, len, src, dst);
        <span class="keywordflow">break</span>;
    <span class="keywordflow">default</span>:
        <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_WARNING, 0, __FUNCTION__,
             <span class="stringliteral">&quot;Unknown msg type %u rcvd from %s to %s&quot;</span>, aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a>,
             <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(src), <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dst));
        <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0addab2c6796c6d480d71b776f2b491b"></a><!-- doxytag: member="NA_aodv_socket.h::aodv_socket_queue_msg" ref="a0addab2c6796c6d480d71b776f2b491b" args="(AODV_msg *aodv_msg, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structAODV__msg.html">AODV_msg</a>* <a class="el" href="NA__aodv__socket_8h.html#a0addab2c6796c6d480d71b776f2b491b">aodv_socket_queue_msg</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAODV__msg.html">AODV_msg</a> *&#160;</td>
          <td class="paramname"><em>aodv_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a16fb4b683d69829242c45cad4530a00a"></a><!-- doxytag: member="NA_aodv_socket.h::aodv_socket_send" ref="a16fb4b683d69829242c45cad4530a00a" args="(AODV_msg *aodv_msg, struct in_addr dst, int len, u_int8_t ttl, struct dev_info *dev, double delay=&#45;1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="NA__aodv__socket_8h.html#a16fb4b683d69829242c45cad4530a00a">aodv_socket_send</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAODV__msg.html">AODV_msg</a> *&#160;</td>
          <td class="paramname"><em>aodv_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct in_addr&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>ttl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structdev__info.html">dev_info</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delay</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8cc_source.html#l00405">405</a> of file <a class="el" href="NA__aodv__socket_8cc_source.html">NA_aodv_socket.cc</a>.</p>
<div class="fragment"><pre class="fragment">{

    <span class="keyword">struct </span>timeval now;
    <span class="keywordtype">int</span> retval = 0;
    <span class="comment">/* Rate limit stuff: */</span>

<span class="preprocessor">#ifdef OMNETPP</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (ttl&lt;=0)
    {
        <span class="keyword">delete</span> aodv_msg;
        <span class="keywordflow">return</span>;
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#ifndef NS_PORT</span>
<span class="preprocessor"></span>
    <span class="keyword">struct </span>sockaddr_in dst_addr;

    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a> &amp;&amp; aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a> == <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a>)
        <span class="keywordflow">return</span>;

    memset(&amp;dst_addr, 0, <span class="keyword">sizeof</span>(dst_addr));
    dst_addr.sin_family = AF_INET;
    dst_addr.sin_addr = dst;
    dst_addr.sin_port = <a class="code" href="NA__aodv__uu__omnet_8h.html#a51799f5ebb4c7228ef7e95c247030f42">htons</a>(<a class="code" href="NA__defs__aodv_8h.html#a8e8ce4ef9316894dd0cce190afef212d">AODV_PORT</a>);

    <span class="comment">/* Set ttl */</span>
    <span class="keywordflow">if</span> (setsockopt(dev-&gt;<a class="code" href="structdev__info.html#a2e3faa44a97d0a1beff0883cf6f8c914">sock</a>, SOL_IP, IP_TTL, &amp;ttl, <span class="keyword">sizeof</span>(ttl)) &lt; 0)
    {
        <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_WARNING, 0, __FUNCTION__, <span class="stringliteral">&quot;ERROR setting ttl!&quot;</span>);
        <span class="keywordflow">return</span>;
    }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>
    <span class="comment">/*</span>
<span class="comment">       NS_PORT: Sending of AODV_msg messages to other AODV-UU routing agents</span>
<span class="comment">       by encapsulating them in a Packet.</span>
<span class="comment"></span>
<span class="comment">       Note: This method is _only_ for sending AODV packets to other routing</span>
<span class="comment">       agents, _not_ for forwarding &quot;regular&quot; IP packets!</span>
<span class="comment">     */</span>

    <span class="comment">/* If we are in waiting phase after reboot, don&#39;t send any RREPs */</span>
    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#ae9b50005184bab60e94309c7a30c5c85">wait_on_reboot</a> &amp;&amp; aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a> == <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a>)
    {
<span class="preprocessor">#ifdef OMNETPP</span>
<span class="preprocessor"></span>        <span class="keyword">delete</span> aodv_msg;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>        <span class="keywordflow">return</span>;
    }
<span class="preprocessor">#ifndef OMNETPP</span>
<span class="preprocessor"></span>    <span class="comment">/*</span>
<span class="comment">       NS_PORT: Don&#39;t allocate packet until now. Otherwise packet uid</span>
<span class="comment">       (unique ID) space is unnecessarily exhausted at the beginning of</span>
<span class="comment">       the simulation, resulting in uid:s starting at values greater than 0.</span>
<span class="comment">     */</span>
    Packet *p = allocpkt();
    <span class="keyword">struct </span>hdr_cmn *ch = HDR_CMN(p);
    <span class="keyword">struct </span>hdr_ip *ih = HDR_IP(p);
    <a class="code" href="structAODV__msg.html">hdr_aodvuu</a> *ah = <a class="code" href="NA__aodv__msg__struct_8h.html#a5b61bd422121b6ca416f6854695343fa">HDR_AODVUU</a>(p);

    <span class="comment">// Clear AODVUU part of packet</span>
    memset(ah, <span class="charliteral">&#39;\0&#39;</span>, ah-&gt;size());

    <span class="comment">// Copy message contents into packet</span>
    memcpy(ah, aodv_msg, len);

    <span class="comment">// Set common header fields</span>
    ch-&gt;ptype() = PT_AODVUU;
    ch-&gt;direction() = hdr_cmn::DOWN;
    ch-&gt;size() = IP_HDR_LEN + len;
    ch-&gt;iface() = -2;
    ch-&gt;getBitErrorRate() = 0;
    ch-&gt;prev_hop_ = (nsaddr_t) dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr;

    <span class="comment">// Set IP header fields</span>
    ih-&gt;saddr() = (nsaddr_t) dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr;
    ih-&gt;daddr() = (nsaddr_t) dst.s_addr;
    ih-&gt;ttl() = ttl;

    <span class="comment">// Note: Port number for routing agents, not AODV port number!</span>
    ih-&gt;sport() = RT_PORT;
    ih-&gt;dport() = RT_PORT;

    <span class="comment">// Fake success</span>
    retval = len;
<span class="preprocessor">#endif </span><span class="comment">/*omnet++ */</span>
<span class="preprocessor">#endif              </span><span class="comment">/* NS_PORT */</span>

    <span class="comment">/* If rate limiting is enabled, check if we are sending either a</span>
<span class="comment">       RREQ or a RERR. In that case, drop the outgoing control packet</span>
<span class="comment">       if the time since last transmit of that type of packet is less</span>
<span class="comment">       than the allowed RATE LIMIT time... */</span>

    <span class="keywordflow">if</span> (<a class="code" href="main_8c.html#a3ecfcf4b066b9c242e176393695e38d0">ratelimit</a>)
    {

        gettimeofday(&amp;now, NULL);

        <span class="keywordflow">switch</span> (aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a>)
        {
        <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a367cd375e15ce9ae860d778bd08ad2d6">AODV_RREQ</a>:
            <span class="keywordflow">if</span> (<a class="code" href="NA__aodv__socket_8h.html#a425356b81e173631ab1116ca2f0464ef">num_rreq</a> == (<a class="code" href="NA__params_8h.html#adc80c7e4d1a44c3a798e7eccf3926466">RREQ_RATELIMIT</a> - 1))
            {
                <span class="keywordflow">if</span> (timeval_diff(&amp;now, &amp;<a class="code" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a>[0]) &lt; 1000)
                {
                    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;RATELIMIT: Dropping RREQ %ld ms&quot;</span>,
                          timeval_diff(&amp;now, &amp;<a class="code" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a>[0]));
<span class="preprocessor">#ifdef OMNETPP</span>
<span class="preprocessor"></span>                    <span class="keyword">delete</span> aodv_msg;
<span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span>                    Packet::free(p);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                    <span class="keywordflow">return</span>;
                }
                <span class="keywordflow">else</span>
                {
                    memmove(<a class="code" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a>, &amp;<a class="code" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a>[1],
                            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval) * (<a class="code" href="NA__aodv__socket_8h.html#a425356b81e173631ab1116ca2f0464ef">num_rreq</a> - 1));
                    memcpy(&amp;<a class="code" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a>[<a class="code" href="NA__aodv__socket_8h.html#a425356b81e173631ab1116ca2f0464ef">num_rreq</a> - 1], &amp;now,
                           <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));
                }
            }
            <span class="keywordflow">else</span>
            {
                memcpy(&amp;<a class="code" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a>[<a class="code" href="NA__aodv__socket_8h.html#a425356b81e173631ab1116ca2f0464ef">num_rreq</a>], &amp;now, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));
                num_rreq++;
            }
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="NA__defs__aodv_8h.html#a81b0117b1fb2a63225257c07e8db2275">AODV_RERR</a>:
            <span class="keywordflow">if</span> (<a class="code" href="NA__aodv__socket_8h.html#a2c5a4291e7e7b1c49583d65ce1c0a679">num_rerr</a> == (<a class="code" href="NA__params_8h.html#a8836c9bf0c32fec641a332c5a10e0c8c">RERR_RATELIMIT</a> - 1))
            {
                <span class="keywordflow">if</span> (timeval_diff(&amp;now, &amp;<a class="code" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a>[0]) &lt; 1000)
                {
                    <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_DEBUG, 0, <span class="stringliteral">&quot;RATELIMIT: Dropping RERR %ld ms&quot;</span>,
                          timeval_diff(&amp;now, &amp;<a class="code" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a>[0]));
<span class="preprocessor">#ifdef OMNETPP</span>
<span class="preprocessor"></span>                    <span class="keyword">delete</span> aodv_msg;
<span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span>                    Packet::free(p);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                    <span class="keywordflow">return</span>;
                }
                <span class="keywordflow">else</span>
                {
                    memmove(<a class="code" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a>, &amp;<a class="code" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a>[1],
                            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval) * (<a class="code" href="NA__aodv__socket_8h.html#a2c5a4291e7e7b1c49583d65ce1c0a679">num_rerr</a> - 1));
                    memcpy(&amp;<a class="code" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a>[<a class="code" href="NA__aodv__socket_8h.html#a2c5a4291e7e7b1c49583d65ce1c0a679">num_rerr</a> - 1], &amp;now,
                           <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));
                }
            }
            <span class="keywordflow">else</span>
            {
                memcpy(&amp;<a class="code" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a>[<a class="code" href="NA__aodv__socket_8h.html#a2c5a4291e7e7b1c49583d65ce1c0a679">num_rerr</a>], &amp;now, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> timeval));
                num_rerr++;
            }
            <span class="keywordflow">break</span>;
        }
    }

    <span class="comment">/* If we broadcast this message we update the time of last broadcast</span>
<span class="comment">       to prevent unnecessary broadcasts of HELLO msg&#39;s */</span>
    <span class="keywordflow">if</span> (dst.s_addr == ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>)))
    {
        gettimeofday(&amp;<a class="code" href="NA__defs__aodv_8h.html#aee5b14001664d0aca9bb3c0c04fc8204">this_host</a>.<a class="code" href="structhost__info.html#ae606abd6c910cacad35a403eef8b1796">bcast_time</a>, NULL);

<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span><span class="preprocessor">#ifndef OMNETPP</span>
<span class="preprocessor"></span>        ch-&gt;addr_type() = NS_AF_NONE;
        sendPacket(p, dst, 0.0);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span><span class="comment">//       IPv4Address   desAddIp4(dst.s_addr);</span>
<span class="comment">//       IPvXAddress destAdd(desAddIp4);</span>
<span class="comment">// In the floading proccess the random delay prevent collision for the synchronization between the nodes.</span>
        ManetAddress destAdd;
        aodv_msg-&gt;<a class="code" href="structAODV__msg.html#a726912b202cff10cc2f9cab2b1040d6e">prevFix</a>=this-&gt;isStaticNode();

        <span class="keywordflow">if</span> (this-&gt;isStaticNode())
        {
            <span class="keywordflow">if</span> (dynamic_cast&lt;RREP*&gt;(aodv_msg))
            {
                <span class="keyword">dynamic_cast&lt;</span><a class="code" href="structRREP.html">RREP</a>*<span class="keyword">&gt;</span>(aodv_msg)-&gt;cost += costStatic;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;RREQ*&gt; (aodv_msg))
            {
                <span class="keyword">dynamic_cast&lt;</span><a class="code" href="structRREQ.html">RREQ</a>*<span class="keyword">&gt;</span>(aodv_msg)-&gt;cost += costStatic;
            }
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">if</span> (dynamic_cast&lt;RREP*&gt;(aodv_msg))
            {
                <span class="keyword">dynamic_cast&lt;</span><a class="code" href="structRREP.html">RREP</a>*<span class="keyword">&gt;</span>(aodv_msg)-&gt;cost += costMobile;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dynamic_cast&lt;RREQ*&gt;(aodv_msg))
            {
                <span class="keyword">dynamic_cast&lt;</span><a class="code" href="structRREQ.html">RREQ</a>*<span class="keyword">&gt;</span>(aodv_msg)-&gt;cost += costMobile;
            }
        }



        <span class="keywordflow">if</span> (dst.s_addr == ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>)))
        {
            destAdd = ManetAddress(IPv4Address::ALLONES_ADDRESS);
        }
        <span class="keywordflow">else</span>
        {
            destAdd = dst.s_addr;
        }
        <span class="keywordflow">if</span> (delay&gt;0)
        {
            <span class="keywordflow">if</span> (useIndex)
                sendToIp(aodv_msg, 654, destAdd, 654, ttl, delay, dev-&gt;<a class="code" href="structdev__info.html#a30b90665688fc12ec5b54d833215d798">ifindex</a>);
            <span class="keywordflow">else</span>
                sendToIp(aodv_msg, 654, destAdd, 654, ttl, delay, dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr);
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">if</span> (useIndex)
                sendToIp(aodv_msg, 654, destAdd, 654, ttl, par (<span class="stringliteral">&quot;broadcastDelay&quot;</span>).doubleValue(), dev-&gt;<a class="code" href="structdev__info.html#a30b90665688fc12ec5b54d833215d798">ifindex</a>);
            <span class="keywordflow">else</span>
                sendToIp(aodv_msg, 654, destAdd, 654, ttl, par (<span class="stringliteral">&quot;broadcastDelay&quot;</span>).doubleValue(), dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr);
        }
        totalSend++;
<span class="comment">//       sendToIp(aodv_msg, 654, destAdd, 654,ttl);</span>
<span class="preprocessor">#endif </span><span class="comment">/*omnet++ */</span>
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        retval = sendto(dev-&gt;<a class="code" href="structdev__info.html#a2e3faa44a97d0a1beff0883cf6f8c914">sock</a>, send_buf, len, 0,
                        (<span class="keyword">struct</span> sockaddr *) &amp;dst_addr, <span class="keyword">sizeof</span>(dst_addr));

        <span class="keywordflow">if</span> (retval &lt; 0)
        {
            <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_WARNING, errno, __FUNCTION__, <span class="stringliteral">&quot;Failed send to bc %s&quot;</span>,
                 <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dst));
            <span class="keywordflow">return</span>;
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    }
    <span class="keywordflow">else</span>
    {

<span class="preprocessor">#ifdef NS_PORT</span>
<span class="preprocessor"></span><span class="preprocessor">#ifndef OMNETPP</span>
<span class="preprocessor"></span>        ch-&gt;addr_type() = NS_AF_INET;
        <span class="comment">/* We trust the decision of next hop for all AODV messages... */</span>
        <span class="keywordflow">if</span> (dst.s_addr == <a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>)
            sendPacket(p, dst, 0.001 * Random::uniform());
        <span class="keywordflow">else</span>
            sendPacket(p, dst, 0.0);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        <span class="comment">// IPv4Address   desAddIp4(dst.s_addr);</span>
        <span class="comment">// IPvXAddress destAdd(desAddIp4);</span>
        ManetAddress destAdd;
        <span class="keywordflow">if</span> (dst.s_addr == ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>)))
        {
            destAdd = ManetAddress(IPv4Address::ALLONES_ADDRESS);
            <span class="keywordflow">if</span> (delay&gt;0)
            {
                <span class="keywordflow">if</span> (useIndex)
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,delay,dev-&gt;<a class="code" href="structdev__info.html#a30b90665688fc12ec5b54d833215d798">ifindex</a>);
                <span class="keywordflow">else</span>
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,delay,dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr);
            }
            <span class="keywordflow">else</span>
            {
                <span class="keywordflow">if</span> (useIndex)
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,par(<span class="stringliteral">&quot;broadcastDelay&quot;</span>).doubleValue(),dev-&gt;<a class="code" href="structdev__info.html#a30b90665688fc12ec5b54d833215d798">ifindex</a>);
                <span class="keywordflow">else</span>
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,par(<span class="stringliteral">&quot;broadcastDelay&quot;</span>).doubleValue(),dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr);
            }
        }
        <span class="keywordflow">else</span>
        {
            destAdd = dst.s_addr;
            <span class="keywordflow">if</span> (delay&gt;0)
            {
                <span class="keywordflow">if</span> (useIndex)
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,delay,dev-&gt;<a class="code" href="structdev__info.html#a30b90665688fc12ec5b54d833215d798">ifindex</a>);
                <span class="keywordflow">else</span>
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,delay,dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr);
            }
            <span class="keywordflow">else</span>
            {
                <span class="keywordflow">if</span> (useIndex)
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,par(<span class="stringliteral">&quot;unicastDelay&quot;</span>).doubleValue(),dev-&gt;<a class="code" href="structdev__info.html#a30b90665688fc12ec5b54d833215d798">ifindex</a>);
                <span class="keywordflow">else</span>
                    sendToIp(aodv_msg, 654, destAdd, 654,ttl,par(<span class="stringliteral">&quot;unicastDelay&quot;</span>).doubleValue(),dev-&gt;<a class="code" href="structdev__info.html#af78a9d3c053812a910dc5e3c43ec724d">ipaddr</a>.s_addr);
            }
        }
        totalSend++;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="preprocessor">#else</span>
<span class="preprocessor"></span>        retval = sendto(dev-&gt;<a class="code" href="structdev__info.html#a2e3faa44a97d0a1beff0883cf6f8c914">sock</a>, send_buf, len, 0,
                        (<span class="keyword">struct</span> sockaddr *) &amp;dst_addr, <span class="keyword">sizeof</span>(dst_addr));

        <span class="keywordflow">if</span> (retval &lt; 0)
        {
            <a class="code" href="NA__debug__aodv_8cc.html#abcaff98caa7648ba8c38888a45cda786">alog</a>(LOG_WARNING, errno, __FUNCTION__, <span class="stringliteral">&quot;Failed send to %s&quot;</span>,
                 <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dst));
            <span class="keywordflow">return</span>;
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    }

    <span class="comment">/* Do not print hello msgs... */</span>
    <span class="keywordflow">if</span> (!(aodv_msg-&gt;<a class="code" href="structAODV__msg.html#ac8bb49e78d157bd3d7a18559d817fa31">type</a> == <a class="code" href="NA__defs__aodv_8h.html#af7e9efddc1616c4a76a54251ff123d7f">AODV_RREP</a> &amp;&amp; (dst.s_addr == ManetAddress(IPv4Address(<a class="code" href="NA__defs__aodv_8h.html#a3f5378171d85f4d025988d72cb9eab3c">AODV_BROADCAST</a>)))))
        <a class="code" href="NA__debug__aodv_8h.html#a313135eee76ddadcadd30d768c95fcae">DEBUG</a>(LOG_INFO, 0, <span class="stringliteral">&quot;AODV msg to %s ttl=%d retval=%u size=%u&quot;</span>,
              <a class="code" href="NA__debug__aodv_8cc.html#acc0381e3baeab5deb9eed755adae18bc">ip_to_str</a>(dst), ttl, retval, len);

    <span class="keywordflow">return</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab131f150a3dd51dbb5d6096fcc9802cb"></a><!-- doxytag: member="NA_aodv_socket.h::cmsg_nxthdr_fix" ref="ab131f150a3dd51dbb5d6096fcc9802cb" args="(struct msghdr *__msg, struct cmsghdr *__cmsg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct cmsghdr* <a class="el" href="NA__aodv__socket_8h.html#ab131f150a3dd51dbb5d6096fcc9802cb">cmsg_nxthdr_fix</a> </td>
          <td>(</td>
          <td class="paramtype">struct msghdr *&#160;</td>
          <td class="paramname"><em>__msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct cmsghdr *&#160;</td>
          <td class="paramname"><em>__cmsg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a2c5a4291e7e7b1c49583d65ce1c0a679"></a><!-- doxytag: member="NA_aodv_socket.h::num_rerr" ref="a2c5a4291e7e7b1c49583d65ce1c0a679" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__aodv__socket_8h.html#a2c5a4291e7e7b1c49583d65ce1c0a679">num_rerr</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00052">52</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<a class="anchor" id="a425356b81e173631ab1116ca2f0464ef"></a><!-- doxytag: member="NA_aodv_socket.h::num_rreq" ref="a425356b81e173631ab1116ca2f0464ef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="NA__aodv__socket_8h.html#a425356b81e173631ab1116ca2f0464ef">num_rreq</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00051">51</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<a class="anchor" id="af77a0c965f322ef8774d5bca4bf3be5b"></a><!-- doxytag: member="NA_aodv_socket.h::rerr_ratel" ref="af77a0c965f322ef8774d5bca4bf3be5b" args="[RERR_RATELIMIT&#45;1]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct timeval <a class="el" href="NA__aodv__socket_8h.html#af77a0c965f322ef8774d5bca4bf3be5b">rerr_ratel</a>[<a class="el" href="NA__params_8h.html#a8836c9bf0c32fec641a332c5a10e0c8c">RERR_RATELIMIT</a>-1]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00050">50</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
<a class="anchor" id="af2583323ca3e17496a047525e241652a"></a><!-- doxytag: member="NA_aodv_socket.h::rreq_ratel" ref="af2583323ca3e17496a047525e241652a" args="[RREQ_RATELIMIT&#45;1]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct timeval <a class="el" href="NA__aodv__socket_8h.html#af2583323ca3e17496a047525e241652a">rreq_ratel</a>[<a class="el" href="NA__params_8h.html#adc80c7e4d1a44c3a798e7eccf3926466">RREQ_RATELIMIT</a>-1]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="NA__aodv__socket_8h_source.html#l00050">50</a> of file <a class="el" href="NA__aodv__socket_8h_source.html">NA_aodv_socket.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="NA__aodv__socket_8h.html">NA_aodv_socket.h</a>      </li>

    <li class="footer">Generated on Fri Oct 18 2013 20:34:56 for NETWORK ATTACKS FRAMEWORK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
